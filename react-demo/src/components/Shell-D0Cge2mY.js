const e={equals:(e,t)=>e===t};let t=k;const n=1,r=2,o={owned:null,cleanups:null,context:null,owner:null};var s=null;let i=null,a=null,u=null,c=null,l=0;function d(t,n){const r={value:t,observers:null,observerSlots:null,comparator:(n=n?Object.assign({},e,n):e).equals||void 0};return[b.bind(r),e=>("function"==typeof e&&(e=e(r.value)),m(r,e))]}function f(e,t,r){y(w(e,t,!1,n))}function h(e,r,o){t=T;const s=w(e,r,!1,n);s.user=!0,c?c.push(s):y(s)}function p(t,n,r){r=r?Object.assign({},e,r):e;const o=w(t,n,!0,0);return o.observers=null,o.observerSlots=null,o.comparator=r.equals||void 0,y(o),b.bind(o)}function g(e){if(null===a)return e();const t=a;a=null;try{return e()}finally{a=t}}function v(){return s}function b(){if(this.sources&&this.state)if(this.state===n)y(this);else{const e=u;u=null,S((()=>R(this)),!1),u=e}if(a){const e=this.observers?this.observers.length:0;a.sources?(a.sources.push(this),a.sourceSlots.push(e)):(a.sources=[this],a.sourceSlots=[e]),this.observers?(this.observers.push(a),this.observerSlots.push(a.sources.length-1)):(this.observers=[a],this.observerSlots=[a.sources.length-1])}return this.value}function m(e,t,r){let o=e.value;return e.comparator&&e.comparator(o,t)||(e.value=t,e.observers&&e.observers.length&&S((()=>{for(let t=0;t<e.observers.length;t+=1){const r=e.observers[t],o=i&&i.running;o&&i.disposed.has(r),(o?r.tState:r.state)||(r.pure?u.push(r):c.push(r),r.observers&&_(r)),o||(r.state=n)}if(u.length>1e6)throw u=[],new Error}),!1)),t}function y(e){if(!e.fn)return;P(e);const t=l;!function(e,t,r){let o;const i=s,u=a;a=s=e;try{o=e.fn(t)}catch(t){return e.pure&&(e.state=n,e.owned&&e.owned.forEach(P),e.owned=null),e.updatedAt=r+1,A(t)}finally{a=u,s=i}(!e.updatedAt||e.updatedAt<=r)&&(null!=e.updatedAt&&"observers"in e?m(e,o):e.value=o,e.updatedAt=r)}(e,e.value,t)}function w(e,t,r,i=n,a){const u={fn:e,state:i,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:s,context:s?s.context:null,pure:r};return null===s||s!==o&&(s.owned?s.owned.push(u):s.owned=[u]),u}function I(e){if(0===e.state)return;if(e.state===r)return R(e);if(e.suspense&&g(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<l);)e.state&&t.push(e);for(let o=t.length-1;o>=0;o--)if((e=t[o]).state===n)y(e);else if(e.state===r){const n=u;u=null,S((()=>R(e,t[0])),!1),u=n}}function S(e,n){if(u)return e();let r=!1;n||(u=[]),c?r=!0:c=[],l++;try{const n=e();return function(e){u&&(k(u),u=null);if(e)return;const n=c;c=null,n.length&&S((()=>t(n)),!1)}(r),n}catch(e){r||(c=null),u=null,A(e)}}function k(e){for(let t=0;t<e.length;t++)I(e[t])}function T(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:I(r)}for(t=0;t<n;t++)I(e[t])}function R(e,t){e.state=0;for(let o=0;o<e.sources.length;o+=1){const s=e.sources[o];if(s.sources){const e=s.state;e===n?s!==t&&(!s.updatedAt||s.updatedAt<l)&&I(s):e===r&&R(s,t)}}}function _(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=r,n.pure?u.push(n):c.push(n),n.observers&&_(n))}}function P(e){let t;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),n=e.sourceSlots.pop(),r=t.observers;if(r&&r.length){const e=r.pop(),o=t.observerSlots.pop();n<r.length&&(e.sourceSlots[o]=n,r[n]=e,t.observerSlots[n]=o)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)P(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function A(e,t=s){const n=function(e){return e instanceof Error?e:new Error("string"==typeof e?e:"Unknown error",{cause:e})}(e);throw n}function x(e,t){return g((()=>e(t||{})))}function O(e){const t=e.keyed,n=p((()=>e.when),void 0,{equals:(e,n)=>t?e===n:!e==!n});return p((()=>{const r=n();if(r){const o=e.children;return"function"==typeof o&&o.length>0?g((()=>o(t?r:()=>{if(!g(n))throw`Stale read from <${"Show"}>.`;return e.when}))):o}return e.fallback}),void 0,void 0)}const E="_$DX_DELEGATE";function C(e,t,n){let r;const o=()=>(r||(r=(()=>{const t=document.createElement("template");return t.innerHTML=e,t.content.firstChild})())).cloneNode(!0);return o.cloneNode=o,o}function D(e,t=window.document){const n=t[E]||(t[E]=new Set);for(let r=0,o=e.length;r<o;r++){const o=e[r];n.has(o)||(n.add(o),t.addEventListener(o,U))}}function M(e,t,n,r){if(void 0===n||r||(r=[]),"function"!=typeof t)return H(e,t,r,n);f((r=>H(e,t(),r,n)),r)}function U(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get:()=>n||document});n;){const r=n[t];if(r&&!n.disabled){const o=n[`${t}Data`];if(void 0!==o?r.call(n,o,e):r.call(n,e),e.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function H(e,t,n,r,o){for(;"function"==typeof n;)n=n();if(t===n)return n;const s=typeof t,i=void 0!==r;if(e=i&&n[0]&&n[0].parentNode||e,"string"===s||"number"===s)if("number"===s&&(t=t.toString()),i){let o=n[0];o&&3===o.nodeType?o.data!==t&&(o.data=t):o=document.createTextNode(t),n=L(e,n,r,o)}else n=""!==n&&"string"==typeof n?e.firstChild.data=t:e.textContent=t;else if(null==t||"boolean"===s)n=L(e,n,r);else{if("function"===s)return f((()=>{let o=t();for(;"function"==typeof o;)o=o();n=H(e,o,n,r)})),()=>n;if(Array.isArray(t)){const s=[],a=n&&Array.isArray(n);if(F(s,t,n,o))return f((()=>n=H(e,s,n,r,!0))),()=>n;if(0===s.length){if(n=L(e,n,r),i)return n}else a?0===n.length?N(e,s,r):function(e,t,n){let r=n.length,o=t.length,s=r,i=0,a=0,u=t[o-1].nextSibling,c=null;for(;i<o||a<s;)if(t[i]!==n[a]){for(;t[o-1]===n[s-1];)o--,s--;if(o===i){const t=s<r?a?n[a-1].nextSibling:n[s-a]:u;for(;a<s;)e.insertBefore(n[a++],t)}else if(s===a)for(;i<o;)c&&c.has(t[i])||t[i].remove(),i++;else if(t[i]===n[s-1]&&n[a]===t[o-1]){const r=t[--o].nextSibling;e.insertBefore(n[a++],t[i++].nextSibling),e.insertBefore(n[--s],r),t[o]=n[s]}else{if(!c){c=new Map;let e=a;for(;e<s;)c.set(n[e],e++)}const r=c.get(t[i]);if(null!=r)if(a<r&&r<s){let u,l=i,d=1;for(;++l<o&&l<s&&null!=(u=c.get(t[l]))&&u===r+d;)d++;if(d>r-a){const o=t[i];for(;a<r;)e.insertBefore(n[a++],o)}else e.replaceChild(n[a++],t[i++])}else i++;else t[i++].remove()}}else i++,a++}(e,n,s):(n&&L(e),N(e,s));n=s}else if(t.nodeType){if(Array.isArray(n)){if(i)return n=L(e,n,r,t);L(e,n,null,t)}else null!=n&&""!==n&&e.firstChild?e.replaceChild(t,e.firstChild):e.appendChild(t);n=t}}return n}function F(e,t,n,r){let o=!1;for(let s=0,i=t.length;s<i;s++){let i,a=t[s],u=n&&n[e.length];if(null==a||!0===a||!1===a);else if("object"==(i=typeof a)&&a.nodeType)e.push(a);else if(Array.isArray(a))o=F(e,a,u)||o;else if("function"===i)if(r){for(;"function"==typeof a;)a=a();o=F(e,Array.isArray(a)?a:[a],Array.isArray(u)?u:[u])||o}else e.push(a),o=!0;else{const t=String(a);u&&3===u.nodeType&&u.data===t?e.push(u):e.push(document.createTextNode(t))}}return o}function N(e,t,n=null){for(let r=0,o=t.length;r<o;r++)e.insertBefore(t[r],n)}function L(e,t,n,r){if(void 0===n)return e.textContent="";const o=r||document.createTextNode("");if(t.length){let r=!1;for(let s=t.length-1;s>=0;s--){const i=t[s];if(o!==i){const t=i.parentNode===e;r||s?t&&i.remove():t?e.replaceChild(o,i):e.insertBefore(o,n)}else r=!0}}else e.insertBefore(o,n);return[o]}function j(e){return Object.keys(e).reduce(((t,n)=>{const r=e[n];var o;return t[n]=Object.assign({},r),B(r.value)&&(o=r.value,"[object Function]"!==Object.prototype.toString.call(o))&&!Array.isArray(r.value)&&(t[n].value=Object.assign({},r.value)),Array.isArray(r.value)&&(t[n].value=r.value.slice(0)),t}),{})}function q(e){if(e)try{return JSON.parse(e)}catch(t){return e}}function V(e,t,n){if(null==n||!1===n)return e.removeAttribute(t);let r=JSON.stringify(n);e.__updating[t]=!0,"true"===r&&(r=""),e.setAttribute(t,r),Promise.resolve().then((()=>delete e.__updating[t]))}function B(e){return null!=e&&("object"==typeof e||"function"==typeof e)}let W;function X(){Object.defineProperty(W,"renderRoot",{value:W})}function G(e,t){const n=Object.keys(t);return class extends e{static get observedAttributes(){return n.map((e=>t[e].attribute))}constructor(){super(),this.__initialized=!1,this.__released=!1,this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props={}}connectedCallback(){if(this.__initialized)return;this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props=function(e,t){const n=j(t);return Object.keys(t).forEach((t=>{const r=n[t],o=e.getAttribute(r.attribute),s=e[t];o&&(r.value=r.parse?q(o):o),null!=s&&(r.value=Array.isArray(s)?s.slice(0):s),r.reflect&&V(e,r.attribute,r.value),Object.defineProperty(e,t,{get:()=>r.value,set(e){const n=r.value;r.value=e,r.reflect&&V(this,r.attribute,r.value);for(let r=0,o=this.__propertyChangedCallbacks.length;r<o;r++)this.__propertyChangedCallbacks[r](t,e,n)},enumerable:!0,configurable:!0})})),n}(this,t);const e=function(e){return Object.keys(e).reduce(((t,n)=>(t[n]=e[n].value,t)),{})}(this.props),n=this.Component,r=W;try{W=this,this.__initialized=!0,"function"==typeof(o=n)&&0===o.toString().indexOf("class")?new n(e,{element:this}):n(e,{element:this})}finally{W=r}var o}async disconnectedCallback(){if(await Promise.resolve(),this.isConnected)return;this.__propertyChangedCallbacks.length=0;let e=null;for(;e=this.__releaseCallbacks.pop();)e(this);delete this.__initialized,this.__released=!0}attributeChangedCallback(e,n,r){if(this.__initialized&&!this.__updating[e]&&(e=this.lookupProp(e))in t){if(null==r&&!this[e])return;this[e]=t[e].parse?q(r):r}}lookupProp(e){if(t)return n.find((n=>e===n||e===t[n].attribute))}get renderRoot(){return this.shadowRoot||this.attachShadow({mode:"open"})}addReleaseCallback(e){this.__releaseCallbacks.push(e)}addPropertyChangedCallback(e){this.__propertyChangedCallbacks.push(e)}}}function z(e,t={},n={}){const{BaseElement:r=HTMLElement,extension:o}=n;return n=>{if(!e)throw new Error("tag is required to register a Component");let s=customElements.get(e);return s?(s.prototype.Component=n,s):(s=G(r,function(e){return e?Object.keys(e).reduce(((t,n)=>{const r=e[n];return t[n]=B(r)&&"value"in r?r:{value:r},t[n].attribute||(t[n].attribute=n.replace(/\.?([A-Z]+)/g,((e,t)=>"-"+t.toLowerCase())).replace("_","-").replace(/^-/,"")),t[n].parse="parse"in t[n]?t[n].parse:"string"!=typeof t[n].value,t}),{}):{}}(t)),s.prototype.Component=n,s.prototype.registeredTag=e,customElements.define(e,s,o),s)}}function Q(e){return(t,n)=>{const{element:r}=n;return function(e,t){const n=a,r=s,i=0===e.length,u=void 0===t?r:t,c=i?o:{owned:null,cleanups:null,context:u?u.context:null,owner:u},l=i?e:()=>e((()=>g((()=>P(c)))));s=c,a=null;try{return S(l,!0)}finally{a=n,s=r}}((o=>{const s=function(e){const t=Object.keys(e),n={};for(let r=0;r<t.length;r++){const[o,s]=d(e[t[r]]);Object.defineProperty(n,t[r],{get:o,set(e){s((()=>e))}})}return n}(t);r.addPropertyChangedCallback(((e,t)=>s[e]=t)),r.addReleaseCallback((()=>{r.renderRoot.textContent="",o()}));const i=e(s,n);return M(r.renderRoot,i)}),function(e){if(e.assignedSlot&&e.assignedSlot._$owner)return e.assignedSlot._$owner;let t=e.parentNode;for(;t&&!t._$owner&&(!t.assignedSlot||!t.assignedSlot._$owner);)t=t.parentNode;return t&&t.assignedSlot?t.assignedSlot._$owner:e._$owner}(r))}}function J(e,t,n){return 2===arguments.length&&(n=t,t={}),z(e,t)(Q(n))}var K=":root{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#242424;color:hsla(0,0%,100%,.87);color-scheme:light dark;font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;font-synthesis:none;font-weight:400;line-height:1.5;text-rendering:optimizeLegibility}a{color:#646cff;font-weight:500;text-decoration:inherit}a:hover{color:#535bf2}body{display:flex;margin:0;min-height:100vh;min-width:320px;place-items:center}h1{font-size:3.2em;line-height:1.1}button{background-color:#1a1a1a;border:1px solid transparent;border-radius:8px;color:hsla(0,0%,100%,.87);cursor:pointer;font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;font-family:inherit;font-size:1em;font-weight:500;padding:.6em 1.2em;transition:border-color .25s}button:hover{border-color:#646cff}button:focus,button:focus-visible{outline:4px auto -webkit-focus-ring-color}@media (prefers-color-scheme:light){:root{background-color:#fff;color:#213547}a:hover{color:#747bff}button{background-color:#f9f9f9}}.form-wrap{display:flex;flex-direction:column;gap:1em}.form-wrap input{border:1px solid #646cff;border-radius:8px;font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;font-family:inherit;font-size:1em;padding:.6em 1em}div.wrapper{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#242424;color:hsla(0,0%,100%,.87);color-scheme:light dark;display:flex;flex-direction:column;font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;font-synthesis:none;font-weight:400;gap:1em;height:100vh;line-height:1.5;text-rendering:optimizeLegibility;width:100vw}div.wrapper header{background:#f93;height:80px}div.wrapper header,div.wrapper main{align-items:center;display:flex;justify-content:center}div.wrapper main{flex-grow:1;min-width:60%}div.wrapper footer{align-items:center;background:#1f1f1f;display:flex;height:60px;justify-content:center}",Y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function $(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Z,ee,te,ne={},re={},oe={},se={},ie={},ae={},ue={};function ce(){if(Z)return ue;Z=1;var e=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},t=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};function n(){if("undefined"==typeof window)throw Error("If you are using this package with server-side rendering, please make sure that you are checking if the window object is defined.");return window}Object.defineProperty(ue,"__esModule",{value:!0}),ue.defaultWindowHandlerImplementation=void 0;var r={key:function(r){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n().localStorage.key(r)]}))}))},clear:function(){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n().localStorage.clear()]}))}))},getItem:function(r){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n().localStorage.getItem(r)]}))}))},removeItem:function(r){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n().localStorage.removeItem(r)]}))}))},setItem:function(r,o){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n().localStorage.setItem(r,o)]}))}))},keySync:function(e){return n().localStorage.key(e)},clearSync:function(){return n().localStorage.clear()},getItemSync:function(e){return n().localStorage.getItem(e)},removeItemSync:function(e){return n().localStorage.removeItem(e)},setItemSync:function(e,t){return n().localStorage.setItem(e,t)}},o={key:function(r){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n().sessionStorage.key(r)]}))}))},clear:function(){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n().sessionStorage.clear()]}))}))},getItem:function(r){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n().sessionStorage.getItem(r)]}))}))},removeItem:function(r){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n().sessionStorage.removeItem(r)]}))}))},setItem:function(r,o){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n().sessionStorage.setItem(r,o)]}))}))},keySync:function(e){return n().sessionStorage.key(e)},clearSync:function(){return n().sessionStorage.clear()},getItemSync:function(e){return n().sessionStorage.getItem(e)},removeItemSync:function(e){return n().sessionStorage.removeItem(e)},setItemSync:function(e,t){return n().sessionStorage.setItem(e,t)}};return ue.defaultWindowHandlerImplementation={history:{replaceState:function(e,t,r){return n().history.replaceState(e,t,r)},getState:function(){return n().history.state}},location:{getHref:function(){return n().location.href},setHref:function(e){n().location.href=e},getSearch:function(){return n().location.search},getHash:function(){return n().location.hash},getPathName:function(){return n().location.pathname},assign:function(e){n().location.assign(e)},getHostName:function(){return n().location.hostname},getHost:function(){return n().location.host},getOrigin:function(){return n().location.origin}},getDocument:function(){return n().document},getWindowUnsafe:function(){return n().window},localStorage:r,sessionStorage:o},ue}function le(){if(ee)return ae;ee=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.WindowHandlerReference=void 0;var e=ce(),t=function(){function t(t){var n=function(e){return e};void 0!==t&&(n=t),this.windowHandler=n(e.defaultWindowHandlerImplementation)}return t.init=function(e){void 0===t.instance&&(t.instance=new t(e))},t.getReferenceOrThrow=function(){if(void 0===t.instance)throw new Error("SuperTokensWindowHandler must be initialized before calling this method.");return t.instance},t}();return ae.WindowHandlerReference=t,ae.default=t,ae}(te=ie).__esModule=!0,function(e){for(var t in e)te.hasOwnProperty(t)||(te[t]=e[t])}(le()),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WindowHandlerReference=void 0;var t=ie;Object.defineProperty(e,"WindowHandlerReference",{enumerable:!0,get:function(){return t.WindowHandlerReference}})}(se);var de={};Object.defineProperty(de,"__esModule",{value:!0}),de.SSR_ERROR=de.DEFAULT_API_BASE_PATH=void 0,de.DEFAULT_API_BASE_PATH="/auth",de.SSR_ERROR="\nIf you are trying to use this method doing server-side-rendering, please make sure you move this method inside a componentDidMount method or useEffect hook.";var fe={};Object.defineProperty(fe,"__esModule",{value:!0});var he=function(e){var t=this;this.getAsStringDangerous=function(){return t.value},this.value=pe(e)};function pe(e,t){void 0===t&&(t=!1),e=e.trim();try{if(!e.startsWith("http://")&&!e.startsWith("https://"))throw new Error("Error converting to proper URL");var n=new URL(e);return e=t?n.hostname.startsWith("localhost")||(r=n.hostname,/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(r))?"http://"+n.host:"https://"+n.host:n.protocol+"//"+n.host}catch(e){}var r;if(e.startsWith("/"))throw new Error("Please provide a valid domain name");if(0===e.indexOf(".")&&(e=e.substr(1)),(-1!==e.indexOf(".")||e.startsWith("localhost"))&&!e.startsWith("http://")&&!e.startsWith("https://")){e="https://"+e;try{return new URL(e),pe(e,!0)}catch(e){}}throw new Error("Please provide a valid domain name")}fe.default=he;var ge={};Object.defineProperty(ge,"__esModule",{value:!0});var ve=function e(t){var n=this;this.startsWith=function(e){return n.value.startsWith(e.value)},this.appendPath=function(t){return new e(n.value+t.value)},this.getAsStringDangerous=function(){return n.value},this.value=be(t)};function be(e){e=e.trim();try{if(!e.startsWith("http://")&&!e.startsWith("https://"))throw new Error("Error converting to proper URL");return"/"===(e=new URL(e).pathname).charAt(e.length-1)?e.substr(0,e.length-1):e}catch(e){}if((function(e){if(-1===e.indexOf(".")||e.startsWith("/"))return!1;try{return-1!==new URL(e).hostname.indexOf(".")}catch(e){}try{return-1!==new URL("http://"+e).hostname.indexOf(".")}catch(e){}return!1}(e)||e.startsWith("localhost"))&&!e.startsWith("http://")&&!e.startsWith("https://"))return be(e="http://"+e);"/"!==e.charAt(0)&&(e="/"+e);try{return new URL("http://example.com"+e),be("http://example.com"+e)}catch(e){throw new Error("Please provide a valid URL path")}}ge.default=ve;var me,ye={},we={},Ie={},Se={};function ke(){if(me)return Se;function e(e){return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}me=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.isAnIpAddress=void 0,Se.isAnIpAddress=e;var t=function(e){var t=this;this.getAsStringDangerous=function(){return t.value},this.value=n(e)};function n(t,r){void 0===r&&(r=!1),t=t.trim();try{if(!t.startsWith("http://")&&!t.startsWith("https://"))throw new Error("converting to proper URL");var o=new URL(t);return t=r?o.hostname.startsWith("localhost")||e(o.hostname)?"http://"+o.host:"https://"+o.host:o.protocol+"//"+o.host}catch(e){}if(t.startsWith("/"))throw new Error("Please provide a valid domain name");if(0===t.indexOf(".")&&(t=t.substr(1)),(-1!==t.indexOf(".")||t.startsWith("localhost"))&&!t.startsWith("http://")&&!t.startsWith("https://")){t="https://"+t;try{return new URL(t),n(t,!0)}catch(e){}}throw new Error("Please provide a valid domain name")}return Se.default=t,Se}var Te,Re,_e={};function Pe(){if(Te)return _e;Te=1,Object.defineProperty(_e,"__esModule",{value:!0});var e=function e(n){var r=this;this.startsWith=function(e){return r.value.startsWith(e.value)},this.appendPath=function(t){return new e(r.value+t.value)},this.getAsStringDangerous=function(){return r.value},this.value=t(n)};function t(e){e=e.trim();try{if(!e.startsWith("http://")&&!e.startsWith("https://"))throw new Error("converting to proper URL");return"/"===(e=new URL(e).pathname).charAt(e.length-1)?e.substr(0,e.length-1):e}catch(e){}if((function(e){if(-1===e.indexOf(".")||e.startsWith("/"))return!1;try{return-1!==new URL(e).hostname.indexOf(".")}catch(e){}try{return-1!==new URL("http://"+e).hostname.indexOf(".")}catch(e){}return!1}(e)||e.startsWith("localhost"))&&!e.startsWith("http://")&&!e.startsWith("https://"))return t(e="http://"+e);"/"!==e.charAt(0)&&(e="/"+e);try{return new URL("http://example.com"+e),t("http://example.com"+e)}catch(e){throw new Error("Please provide a valid URL path")}}return _e.default=e,_e}function Ae(){if(Re)return Ie;Re=1;var e=Y&&Y.__assign||function(){return e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},e.apply(this,arguments)},t=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},n=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.getNormalisedUserContext=Ie.validateAndNormaliseInputOrThrowError=Ie.normaliseSessionScopeOrThrowError=Ie.normaliseURLPathOrThrowError=Ie.normaliseURLDomainOrThrowError=void 0;var r=ke(),o=Pe(),s=le();function i(e){return new r.default(e).getAsStringDangerous()}function a(e){return new o.default(e).getAsStringDangerous()}function u(e){var t=function(e){(e=e.trim().toLowerCase()).startsWith(".")&&(e=e.substr(1)),e.startsWith("http://")||e.startsWith("https://")||(e="http://"+e);try{return(e=new URL(e).hostname).startsWith(".")&&(e=e.substr(1)),e}catch(e){throw new Error("Please provide a valid sessionTokenFrontendDomain")}}(e);return"localhost"===t||(0,r.isAnIpAddress)(t)?t:e.startsWith(".")?"."+t:t}return Ie.normaliseURLDomainOrThrowError=i,Ie.normaliseURLPathOrThrowError=a,Ie.normaliseSessionScopeOrThrowError=u,Ie.validateAndNormaliseInputOrThrowError=function(r){var o=this,c=i(r.apiDomain),l=a("/auth");void 0!==r.apiBasePath&&(l=a(r.apiBasePath));var d=s.default.getReferenceOrThrow().windowHandler.location.getHostName(),f=u(void 0!==r&&void 0!==r.sessionTokenFrontendDomain?r.sessionTokenFrontendDomain:d),h=401;void 0!==r.sessionExpiredStatusCode&&(h=r.sessionExpiredStatusCode);var p=403;if(void 0!==r.invalidClaimStatusCode&&(p=r.invalidClaimStatusCode),h===p)throw new Error("sessionExpiredStatusCode and invalidClaimStatusCode cannot be the same.");var g=!0;void 0!==r.autoAddCredentials&&(g=r.autoAddCredentials);var v=!1;void 0!==r.isInIframe&&(v=r.isInIframe);var b=void 0;void 0!==r.sessionTokenBackendDomain&&(b=u(r.sessionTokenBackendDomain));var m=function(e){return t(o,void 0,void 0,(function(){return n(this,(function(t){return[2,{url:e.url,requestInit:e.requestInit}]}))}))};void 0!==r.preAPIHook&&(m=r.preAPIHook);var y=function(){return t(o,void 0,void 0,(function(){return n(this,(function(e){return[2]}))}))};void 0!==r.postAPIHook&&(y=r.postAPIHook);var w=function(){};void 0!==r.onHandleEvent&&(w=r.onHandleEvent);var I=e({functions:function(e){return e}},r.override);return{apiDomain:c,apiBasePath:l,sessionTokenFrontendDomain:f,sessionExpiredStatusCode:h,invalidClaimStatusCode:p,autoAddCredentials:g,isInIframe:v,tokenTransferMethod:void 0!==r.tokenTransferMethod?r.tokenTransferMethod:"cookie",sessionTokenBackendDomain:b,preAPIHook:m,postAPIHook:y,onHandleEvent:w,override:I}},Ie.getNormalisedUserContext=function(e){return void 0===e?{}:e},Ie}var xe,Oe={},Ee={};function Ce(){return xe||(xe=1,function(e){var t,n=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},r=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ProcessState=e.PROCESS_STATE=void 0,(t=e.PROCESS_STATE||(e.PROCESS_STATE={}))[t.CALLING_INTERCEPTION_REQUEST=0]="CALLING_INTERCEPTION_REQUEST",t[t.CALLING_INTERCEPTION_RESPONSE=1]="CALLING_INTERCEPTION_RESPONSE";var o=function(){function e(){var e=this;this.history=[],this.addState=function(t){try{void 0!==process&&void 0!==process.env&&"testing"===process.env.TEST_MODE&&e.history.push(t)}catch(e){}},this.getEventByLastEventByName=function(t){for(var n=e.history.length-1;n>=0;n--)if(e.history[n]==t)return e.history[n]},this.reset=function(){e.history=[]},this.waitForEvent=function(t,o){return void 0===o&&(o=7e3),n(e,void 0,void 0,(function(){var e,n=this;return r(this,(function(r){return e=Date.now(),[2,new Promise((function(r){var s=n;!function n(){var i=s.getEventByLastEventByName(t);void 0===i?Date.now()-e>o?r(void 0):setTimeout(n,1e3):r(i)}()}))]}))}))}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e}();e.ProcessState=o}(Ee)),Ee}var De,Me={};function Ue(){return De||(De=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.supported_fdi=Me.package_version=void 0,Me.package_version="19.0.1",Me.supported_fdi=["1.16","1.17","1.18","1.19"]),Me}var He,Fe,Ne={},Le={};function je(){if(He)return Le;He=1;var e=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},t=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(Le,"__esModule",{value:!0}),Le.defaultCookieHandlerImplementation=void 0;var n=le();return Le.defaultCookieHandlerImplementation={getCookie:function(){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n.default.getReferenceOrThrow().windowHandler.getWindowUnsafe().document.cookie]}))}))},setCookie:function(r){return e(this,void 0,void 0,(function(){return t(this,(function(e){return n.default.getReferenceOrThrow().windowHandler.getWindowUnsafe().document.cookie=r,[2]}))}))}},Le}function qe(){if(Fe)return Ne;Fe=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.CookieHandlerReference=void 0;var e=je(),t=function(){function t(t){var n=function(e){return e};void 0!==t&&(n=t),this.cookieHandler=n(e.defaultCookieHandlerImplementation)}return t.init=function(e){void 0===t.instance&&(t.instance=new t(e))},t.getReferenceOrThrow=function(){if(void 0===t.instance)throw new Error("SuperTokensCookieHandler must be initialized before calling this method.");return t.instance},t}();return Ne.CookieHandlerReference=t,Ne.default=t,Ne}var Ve,Be,We,Xe={},Ge={},ze={};function Qe(){if(Be)return Ge;Be=1;var e=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(i,a)}u((r=r.apply(e,t||[])).next())}))},t=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},n=Y;Object.defineProperty(Ge,"__esModule",{value:!0});var r=function(){if(Ve)return ze;Ve=1,Object.defineProperty(ze,"__esModule",{value:!0});var e=function(){function e(){var e=this;this.locked=new Map,this.addToLocked=function(t,n){var r=e.locked.get(t);void 0===r?void 0===n?e.locked.set(t,[]):e.locked.set(t,[n]):void 0!==n&&(r.unshift(n),e.locked.set(t,r))},this.isLocked=function(t){return e.locked.has(t)},this.lock=function(t){return new Promise((function(n,r){e.isLocked(t)?e.addToLocked(t,n):(e.addToLocked(t),n())}))},this.unlock=function(t){var n=e.locked.get(t);if(void 0!==n&&0!==n.length){var r=n.pop();e.locked.set(t,n),void 0!==r&&setTimeout(r,0)}else e.locked.delete(t)}}return e.getInstance=function(){return void 0===e.instance&&(e.instance=new e),e.instance},e}();return ze.default=function(){return e.getInstance()},ze}(),o="browser-tabs-lock-key",s={key:function(r){return e(n,void 0,void 0,(function(){return t(this,(function(e){throw new Error("Unsupported")}))}))},getItem:function(r){return e(n,void 0,void 0,(function(){return t(this,(function(e){throw new Error("Unsupported")}))}))},clear:function(){return e(n,void 0,void 0,(function(){return t(this,(function(e){return[2,window.localStorage.clear()]}))}))},removeItem:function(r){return e(n,void 0,void 0,(function(){return t(this,(function(e){throw new Error("Unsupported")}))}))},setItem:function(r,o){return e(n,void 0,void 0,(function(){return t(this,(function(e){throw new Error("Unsupported")}))}))},keySync:function(e){return window.localStorage.key(e)},getItemSync:function(e){return window.localStorage.getItem(e)},clearSync:function(){return window.localStorage.clear()},removeItemSync:function(e){return window.localStorage.removeItem(e)},setItemSync:function(e,t){return window.localStorage.setItem(e,t)}};function i(e){return new Promise((function(t){return setTimeout(t,e)}))}function a(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",n="",r=0;r<e;r++){n+=t[Math.floor(61*Math.random())]}return n}var u=function(){function n(e){this.acquiredIatSet=new Set,this.storageHandler=void 0,this.id=Date.now().toString()+a(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),this.storageHandler=e,void 0===n.waiters&&(n.waiters=[])}return n.prototype.acquireLock=function(r,u){return void 0===u&&(u=5e3),e(this,void 0,void 0,(function(){var e,c,l,d,f,h,p;return t(this,(function(t){switch(t.label){case 0:e=Date.now()+a(4),c=Date.now()+u,l=o+"-"+r,d=void 0===this.storageHandler?s:this.storageHandler,t.label=1;case 1:return Date.now()<c?[4,i(30)]:[3,8];case 2:return t.sent(),null!==d.getItemSync(l)?[3,5]:(f=this.id+"-"+r+"-"+e,[4,i(Math.floor(25*Math.random()))]);case 3:return t.sent(),d.setItemSync(l,JSON.stringify({id:this.id,iat:e,timeoutKey:f,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,i(30)];case 4:return t.sent(),null!==(h=d.getItemSync(l))&&(p=JSON.parse(h)).id===this.id&&p.iat===e?(this.acquiredIatSet.add(e),this.refreshLockWhileAcquired(l,e),[2,!0]):[3,7];case 5:return n.lockCorrector(void 0===this.storageHandler?s:this.storageHandler),[4,this.waitForSomethingToChange(c)];case 6:t.sent(),t.label=7;case 7:return e=Date.now()+a(4),[3,1];case 8:return[2,!1]}}))}))},n.prototype.refreshLockWhileAcquired=function(n,o){return e(this,void 0,void 0,(function(){var i=this;return t(this,(function(a){return setTimeout((function(){return e(i,void 0,void 0,(function(){var e,i,a;return t(this,(function(t){switch(t.label){case 0:return[4,r.default().lock(o)];case 1:return t.sent(),this.acquiredIatSet.has(o)?(e=void 0===this.storageHandler?s:this.storageHandler,null===(i=e.getItemSync(n))?(r.default().unlock(o),[2]):((a=JSON.parse(i)).timeRefreshed=Date.now(),e.setItemSync(n,JSON.stringify(a)),r.default().unlock(o),this.refreshLockWhileAcquired(n,o),[2])):(r.default().unlock(o),[2])}}))}))}),1e3),[2]}))}))},n.prototype.waitForSomethingToChange=function(r){return e(this,void 0,void 0,(function(){return t(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){var t=!1,o=Date.now(),s=!1;function i(){if(s||(window.removeEventListener("storage",i),n.removeFromWaiting(i),clearTimeout(a),s=!0),!t){t=!0;var r=50-(Date.now()-o);r>0?setTimeout(e,r):e(null)}}window.addEventListener("storage",i),n.addToWaiting(i);var a=setTimeout(i,Math.max(0,r-Date.now()))}))];case 1:return e.sent(),[2]}}))}))},n.addToWaiting=function(e){this.removeFromWaiting(e),void 0!==n.waiters&&n.waiters.push(e)},n.removeFromWaiting=function(e){void 0!==n.waiters&&(n.waiters=n.waiters.filter((function(t){return t!==e})))},n.notifyWaiters=function(){void 0!==n.waiters&&n.waiters.slice().forEach((function(e){return e()}))},n.prototype.releaseLock=function(n){return e(this,void 0,void 0,(function(){return t(this,(function(e){switch(e.label){case 0:return[4,this.releaseLock__private__(n)];case 1:return[2,e.sent()]}}))}))},n.prototype.releaseLock__private__=function(i){return e(this,void 0,void 0,(function(){var e,a,u,c;return t(this,(function(t){switch(t.label){case 0:return e=void 0===this.storageHandler?s:this.storageHandler,a=o+"-"+i,null===(u=e.getItemSync(a))?[2]:(c=JSON.parse(u)).id!==this.id?[3,2]:[4,r.default().lock(c.iat)];case 1:t.sent(),this.acquiredIatSet.delete(c.iat),e.removeItemSync(a),r.default().unlock(c.iat),n.notifyWaiters(),t.label=2;case 2:return[2]}}))}))},n.lockCorrector=function(e){for(var t=Date.now()-5e3,r=e,s=[],i=0;;){var a=r.keySync(i);if(null===a)break;s.push(a),i++}for(var u=!1,c=0;c<s.length;c++){var l=s[c];if(l.includes(o)){var d=r.getItemSync(l);if(null!==d){var f=JSON.parse(d);(void 0===f.timeRefreshed&&f.timeAcquired<t||void 0!==f.timeRefreshed&&f.timeRefreshed<t)&&(r.removeItemSync(l),u=!0)}}}u&&n.notifyWaiters()},n.waiters=void 0,n}();return Ge.default=u,Ge}function Je(){if(We)return Xe;We=1,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.LockFactoryReference=void 0;var e=Qe(),t=function(){function t(e){this.lockFactory=e}return t.init=function(n,r){void 0===this.instance&&(this.instance=new t(null!=n?n:function(t){return function(){return Promise.resolve(new e.default(t))}}(r)))},t.getReferenceOrThrow=function(){if(void 0===t.instance)throw new Error("SuperTokensLockReference must be initialized before calling this method.");return t.instance},t}();return Xe.LockFactoryReference=t,Xe.default=t,Xe}var Ke,Ye={};function $e(){if(Ke)return Ye;Ke=1,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.logDebugMessage=Ye.disableLogging=Ye.enableLogging=void 0;var e=Ue(),t=!1;return Ye.enableLogging=function(){t=!0},Ye.disableLogging=function(){t=!1},Ye.logDebugMessage=function(n){t&&console.log("".concat("com.supertokens",' {t: "').concat((new Date).toISOString(),'", message: "').concat(n,'", supertokens-website-ver: "').concat(e.package_version,'"}'))},Ye}var Ze,et,tt,nt={},rt={};function ot(){if(et)return nt;et=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.DateProviderReference=void 0;var e=function(){if(Ze)return rt;Ze=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.DateProvider=void 0;var e=le(),t=function(){function t(){this.clockSkewInMillis=0,this.thresholdInSeconds=7}return t.init=function(){if(void 0===t.instance){t.instance=new t;var n=e.default.getReferenceOrThrow().windowHandler.localStorage.getItemSync(t.CLOCK_SKEW_KEY),r=null!==n?parseInt(n,10):0;t.instance.setClientClockSkewInMillis(r)}},t.getReferenceOrThrow=function(){if(void 0===t.instance)throw new Error("DateProvider must be initialized before calling this method.");return t.instance},t.prototype.getThresholdInSeconds=function(){return this.thresholdInSeconds},t.prototype.setThresholdInSeconds=function(e){this.thresholdInSeconds=e},t.prototype.setClientClockSkewInMillis=function(n){this.clockSkewInMillis=Math.abs(n)>=1e3*this.thresholdInSeconds?n:0,e.default.getReferenceOrThrow().windowHandler.localStorage.setItemSync(t.CLOCK_SKEW_KEY,String(n))},t.prototype.getClientClockSkewInMillis=function(){return this.clockSkewInMillis},t.prototype.now=function(){return Date.now()+this.getClientClockSkewInMillis()},t.CLOCK_SKEW_KEY="__st_clockSkewInMillis",t}();return rt.DateProvider=t,rt}(),t=function(){function t(t){void 0!==t?this.dateProvider=t():(e.DateProvider.init(),this.dateProvider=e.DateProvider.getReferenceOrThrow())}return t.init=function(e){void 0===t.instance&&(t.instance=new t(e))},t.getReferenceOrThrow=function(){if(void 0===t.instance)throw new Error("SuperTokensDateProvider must be initialized before calling this method.");return t.instance},t}();return nt.DateProviderReference=t,nt.default=t,nt}function st(){return tt||(tt=1,function(e){var t=Y&&Y.__assign||function(){return t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.apply(this,arguments)},n=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},r=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.updateClockSkewUsingFrontToken=e.fireSessionUpdateEventsIfNecessary=e.setFrontToken=e.getFrontToken=e.setAntiCSRF=e.saveLastAccessTokenUpdate=e.getTokenForHeaderAuth=e.setToken=e.getStorageNameForToken=e.getLocalSessionState=e.onInvalidClaimResponse=e.onTokenUpdate=e.onUnauthorisedResponse=e.FrontToken=e.AntiCsrfToken=void 0;var o=Ce(),s=Ue(),i=qe(),a=le(),u=Je(),c=$e(),l=ot(),d=function(){function e(){}return e.getToken=function(t){return n(this,void 0,void 0,(function(){var n;return r(this,(function(r){switch(r.label){case 0:return(0,c.logDebugMessage)("AntiCsrfToken.getToken: called"),void 0===t?(e.tokenInfo=void 0,(0,c.logDebugMessage)("AntiCsrfToken.getToken: returning undefined"),[2,void 0]):void 0!==e.tokenInfo?[3,2]:[4,E()];case 1:return null===(n=r.sent())?((0,c.logDebugMessage)("AntiCsrfToken.getToken: returning undefined"),[2,void 0]):(e.tokenInfo={antiCsrf:n,associatedAccessTokenUpdate:t},[3,4]);case 2:return e.tokenInfo.associatedAccessTokenUpdate===t?[3,4]:(e.tokenInfo=void 0,[4,e.getToken(t)]);case 3:return[2,r.sent()];case 4:return(0,c.logDebugMessage)("AntiCsrfToken.getToken: returning: "+e.tokenInfo.antiCsrf),[2,e.tokenInfo.antiCsrf]}}))}))},e.removeToken=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return(0,c.logDebugMessage)("AntiCsrfToken.removeToken: called"),e.tokenInfo=void 0,[4,C(void 0)];case 1:return t.sent(),[2]}}))}))},e.setItem=function(t,o){return n(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return void 0===t?(e.tokenInfo=void 0,[2]):((0,c.logDebugMessage)("AntiCsrfToken.setItem: called"),[4,C(o)]);case 1:return n.sent(),e.tokenInfo={antiCsrf:o,associatedAccessTokenUpdate:t},[2]}}))}))},e}();e.AntiCsrfToken=d;var f=function(){function e(){}return e.getTokenInfo=function(){return n(this,void 0,void 0,(function(){var t,n;return r(this,(function(r){switch(r.label){case 0:return(0,c.logDebugMessage)("FrontToken.getTokenInfo: called"),[4,U()];case 1:return null!==(t=r.sent())?[3,5]:[4,S(!1)];case 2:return"EXISTS"!==r.sent().status?[3,4]:[4,new Promise((function(t){e.waiters.push(t)}))];case 3:return r.sent(),[2,e.getTokenInfo()];case 4:return[2,void 0];case 5:return n=M(t),(0,c.logDebugMessage)("FrontToken.getTokenInfo: returning ate: "+n.ate),(0,c.logDebugMessage)("FrontToken.getTokenInfo: returning uid: "+n.uid),(0,c.logDebugMessage)("FrontToken.getTokenInfo: returning up: "+n.up),[2,n]}}))}))},e.removeToken=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return(0,c.logDebugMessage)("FrontToken.removeToken: called"),[4,H(void 0)];case 1:return t.sent(),[4,T("access","")];case 2:return t.sent(),[4,T("refresh","")];case 3:return t.sent(),e.waiters.forEach((function(e){return e(void 0)})),e.waiters=[],[2]}}))}))},e.setItem=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return[4,O()];case 1:return n.sent(),"remove"===t?[2,e.removeToken()]:((0,c.logDebugMessage)("FrontToken.setItem: called"),[4,H(t)]);case 2:return n.sent(),e.waiters.forEach((function(e){return e(void 0)})),e.waiters=[],[2]}}))}))},e.doesTokenExists=function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,D()];case 1:return[2,null!==e.sent()]}}))}))},e.waiters=[],e}();e.FrontToken=f;var h=function(){function e(){}var s;return e.init=function(t,n){(0,c.logDebugMessage)("init: called"),(0,c.logDebugMessage)("init: Input apiBasePath: "+t.apiBasePath),(0,c.logDebugMessage)("init: Input apiDomain: "+t.apiDomain),(0,c.logDebugMessage)("init: Input autoAddCredentials: "+t.autoAddCredentials),(0,c.logDebugMessage)("init: Input sessionTokenBackendDomain: "+t.sessionTokenBackendDomain),(0,c.logDebugMessage)("init: Input isInIframe: "+t.isInIframe),(0,c.logDebugMessage)("init: Input sessionExpiredStatusCode: "+t.sessionExpiredStatusCode),(0,c.logDebugMessage)("init: Input sessionTokenFrontendDomain: "+t.sessionTokenFrontendDomain),(0,c.logDebugMessage)("init: Input tokenTransferMethod: "+t.tokenTransferMethod);var r=a.default.getReferenceOrThrow().windowHandler.getWindowUnsafe();e.env=void 0===r||void 0===r.fetch?Y:r,e.refreshTokenUrl=t.apiDomain+t.apiBasePath+"/session/refresh",e.signOutUrl=t.apiDomain+t.apiBasePath+"/signout",e.rid="session",e.config=t,void 0===e.env.__supertokensOriginalFetch&&((0,c.logDebugMessage)("init: __supertokensOriginalFetch is undefined"),e.env.__supertokensOriginalFetch=e.env.fetch.bind(e.env),e.env.__supertokensSessionRecipe=n,e.env.fetch=e.env.__supertokensSessionRecipe.addFetchInterceptorsAndReturnModifiedFetch({originalFetch:e.env.__supertokensOriginalFetch,userContext:{}}),e.env.__supertokensSessionRecipe.addXMLHttpRequestInterceptor({userContext:{}})),e.recipeImpl=e.env.__supertokensSessionRecipe,e.initCalled=!0},s=e,e.initCalled=!1,e.doRequest=function(i,u,l){return n(void 0,void 0,void 0,(function(){var n,h,p,g,v,b,m,w,k,T,R,P,O;return r(s,(function(r){switch(r.label){case 0:if(!e.initCalled)throw Error("init function not called");(0,c.logDebugMessage)("doRequest: start of fetch interception"),n=!1;try{h=void 0,"string"==typeof l?h=l:"object"==typeof l&&("string"==typeof l.url?h=l.url:"string"==typeof l.href&&(h=l.href)),n=!e.recipeImpl.shouldDoInterceptionBasedOnUrl(h,e.config.apiDomain,e.config.sessionTokenBackendDomain)}catch(t){if("Please provide a valid domain name"!==t.message)throw t;(0,c.logDebugMessage)("doRequest: Trying shouldDoInterceptionBasedOnUrl with location.origin"),n=!e.recipeImpl.shouldDoInterceptionBasedOnUrl(a.default.getReferenceOrThrow().windowHandler.location.getOrigin(),e.config.apiDomain,e.config.sessionTokenBackendDomain)}return(0,c.logDebugMessage)("doRequest: Value of doNotDoInterception: "+n),n?((0,c.logDebugMessage)("doRequest: Returning without interception"),[4,i(u)]):[3,2];case 1:return[2,r.sent()];case 2:return(p=new Headers(void 0!==u&&void 0!==u.headers?u.headers:l.headers)).has("Authorization")?[4,_("access")]:[3,5];case 3:return g=r.sent(),[4,_("refresh")];case 4:v=r.sent(),void 0!==g&&void 0!==v&&p.get("Authorization")==="Bearer ".concat(g)&&((0,c.logDebugMessage)("doRequest: Removing Authorization from user provided headers because it contains our access token"),p.delete("Authorization")),r.label=5;case 5:(0,c.logDebugMessage)("doRequest: Interception started"),o.ProcessState.getInstance().addState(o.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),r.label=6;case 6:r.trys.push([6,,20,25]),b=void 0,r.label=7;case 7:return[4,S(!0)];case 8:return m=r.sent(),w=new Headers(p),k=t(t({},u),{headers:w}),"EXISTS"!==m.status?[3,10]:[4,d.getToken(m.lastAccessTokenUpdate)];case 9:void 0!==(T=r.sent())&&((0,c.logDebugMessage)("doRequest: Adding anti-csrf token to request"),w.set("anti-csrf",T)),r.label=10;case 10:return e.config.autoAddCredentials&&((0,c.logDebugMessage)("doRequest: Adding credentials include"),void 0===k?k={credentials:"include"}:void 0===k.credentials&&(k=t(t({},k),{credentials:"include"}))),w.has("rid")?(0,c.logDebugMessage)("doRequest: rid header was already there in request"):((0,c.logDebugMessage)("doRequest: Adding rid header: anti-csrf"),w.set("rid","anti-csrf")),R=e.config.tokenTransferMethod,(0,c.logDebugMessage)("doRequest: Adding st-auth-mode header: "+R),w.set("st-auth-mode",R),[4,A(w)];case 11:return r.sent(),(0,c.logDebugMessage)("doRequest: Making user's http call"),[4,i(k)];case 12:return P=r.sent(),(0,c.logDebugMessage)("doRequest: User's http call ended"),[4,x(P)];case 13:return r.sent(),F("EXISTS"===m.status,P.status,P.headers.get("front-token")),P.status!==e.config.sessionExpiredStatusCode?[3,15]:((0,c.logDebugMessage)("doRequest: Status code is: "+P.status),[4,y(m)]);case 14:return"RETRY"!==(O=r.sent()).result?((0,c.logDebugMessage)("doRequest: Not retrying original request"),b=void 0!==O.error?O.error:P,[3,19]):((0,c.logDebugMessage)("doRequest: Retrying original request"),[3,18]);case 15:return P.status!==e.config.invalidClaimStatusCode?[3,17]:[4,I(P)];case 16:r.sent(),r.label=17;case 17:return[2,P];case 18:return[3,7];case 19:return[2,b];case 20:return[4,S(!1)];case 21:return"NOT_EXISTS"!==r.sent().status?[3,24]:((0,c.logDebugMessage)("doRequest: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,d.removeToken()]);case 22:return r.sent(),[4,f.removeToken()];case 23:r.sent(),r.label=24;case 24:return[7];case 25:return[2]}}))}))},e.attemptRefreshingSession=function(){return n(void 0,void 0,void 0,(function(){var t;return r(s,(function(n){switch(n.label){case 0:if(!e.initCalled)throw Error("init function not called");return[4,S(!1)];case 1:return[4,y(n.sent())];case 2:if("API_ERROR"===(t=n.sent()).result)throw t.error;return[2,"RETRY"===t.result]}}))}))},e}();e.default=h;var p="st-last-access-token-update",g="st-refresh-token",v="st-access-token",b="sAntiCsrf",m="sFrontToken";function y(e){return n(this,void 0,void 0,(function(){var t,n,o,i,a,l,p,g,v,b;return r(this,(function(r){switch(r.label){case 0:return[4,u.default.getReferenceOrThrow().lockFactory()];case 1:t=r.sent(),r.label=2;case 2:return(0,c.logDebugMessage)("onUnauthorisedResponse: trying to acquire lock"),[4,t.acquireLock("REFRESH_TOKEN_USE",1e3)];case 3:if(!r.sent())return[3,24];(0,c.logDebugMessage)("onUnauthorisedResponse: lock acquired"),r.label=4;case 4:return r.trys.push([4,16,18,24]),[4,S(!1)];case 5:return"NOT_EXISTS"===(n=r.sent()).status?((0,c.logDebugMessage)("onUnauthorisedResponse: Not refreshing because local session state is NOT_EXISTS"),h.config.onHandleEvent({action:"UNAUTHORISED",sessionExpiredOrRevoked:!1,userContext:{}}),[2,{result:"SESSION_EXPIRED"}]):n.status!==e.status||"EXISTS"===n.status&&"EXISTS"===e.status&&n.lastAccessTokenUpdate!==e.lastAccessTokenUpdate?((0,c.logDebugMessage)("onUnauthorisedResponse: Retrying early because pre and post lastAccessTokenUpdate don't match"),[2,{result:"RETRY"}]):(o=new Headers,"EXISTS"!==e.status?[3,7]:[4,d.getToken(e.lastAccessTokenUpdate)]);case 6:void 0!==(i=r.sent())&&((0,c.logDebugMessage)("onUnauthorisedResponse: Adding anti-csrf token to refresh API call"),o.set("anti-csrf",i)),r.label=7;case 7:return(0,c.logDebugMessage)("onUnauthorisedResponse: Adding rid and fdi-versions to refresh call header"),o.set("rid",h.rid),o.set("fdi-version",s.supported_fdi.join(",")),a=h.config.tokenTransferMethod,(0,c.logDebugMessage)("onUnauthorisedResponse: Adding st-auth-mode header: "+a),o.set("st-auth-mode",a),[4,A(o,!0)];case 8:return r.sent(),(0,c.logDebugMessage)("onUnauthorisedResponse: Calling refresh pre API hook"),[4,h.config.preAPIHook({action:"REFRESH_SESSION",requestInit:{method:"post",credentials:"include",headers:o},url:h.refreshTokenUrl,userContext:{}})];case 9:return l=r.sent(),(0,c.logDebugMessage)("onUnauthorisedResponse: Making refresh call"),[4,h.env.__supertokensOriginalFetch(l.url,l.requestInit)];case 10:return p=r.sent(),(0,c.logDebugMessage)("onUnauthorisedResponse: Refresh call ended"),[4,x(p)];case 11:return r.sent(),(0,c.logDebugMessage)("onUnauthorisedResponse: Refresh status code is: "+p.status),(g=p.status===h.config.sessionExpiredStatusCode)&&null===p.headers.get("front-token")?[4,f.setItem("remove")]:[3,13];case 12:r.sent(),r.label=13;case 13:if(F("EXISTS"===e.status,p.status,g&&null===p.headers.get("front-token")?"remove":p.headers.get("front-token")),p.status>=300)throw p;return[4,h.config.postAPIHook({action:"REFRESH_SESSION",fetchResponse:p.clone(),requestInit:l.requestInit,url:l.url,userContext:{}})];case 14:return r.sent(),[4,S(!1)];case 15:return"NOT_EXISTS"===r.sent().status?((0,c.logDebugMessage)("onUnauthorisedResponse: local session doesn't exist, so returning session expired"),[2,{result:"SESSION_EXPIRED"}]):(h.config.onHandleEvent({action:"REFRESH_SESSION",userContext:{}}),(0,c.logDebugMessage)("onUnauthorisedResponse: Sending RETRY signal"),[2,{result:"RETRY"}]);case 16:return v=r.sent(),[4,S(!1)];case 17:return"NOT_EXISTS"===r.sent().status?((0,c.logDebugMessage)("onUnauthorisedResponse: local session doesn't exist, so returning session expired"),[2,{result:"SESSION_EXPIRED",error:v}]):((0,c.logDebugMessage)("onUnauthorisedResponse: sending API_ERROR"),[2,{result:"API_ERROR",error:v}]);case 18:return[4,t.releaseLock("REFRESH_TOKEN_USE")];case 19:return r.sent(),(0,c.logDebugMessage)("onUnauthorisedResponse: Released lock"),[4,S(!1)];case 20:return"NOT_EXISTS"!==r.sent().status?[3,23]:((0,c.logDebugMessage)("onUnauthorisedResponse: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,d.removeToken()]);case 21:return r.sent(),[4,f.removeToken()];case 22:r.sent(),r.label=23;case 23:return[7];case 24:return[4,S(!1)];case 25:return"NOT_EXISTS"===(b=r.sent()).status?((0,c.logDebugMessage)("onUnauthorisedResponse: lock acquired failed and local session doesn't exist, so sending SESSION_EXPIRED"),[2,{result:"SESSION_EXPIRED"}]):b.status!==e.status||"EXISTS"===b.status&&"EXISTS"===e.status&&b.lastAccessTokenUpdate!==e.lastAccessTokenUpdate?((0,c.logDebugMessage)("onUnauthorisedResponse: lock acquired failed and retrying early because pre and post lastAccessTokenUpdate don't match"),[2,{result:"RETRY"}]):[3,2];case 26:return[2]}}))}))}function w(){(0,c.logDebugMessage)("onTokenUpdate: firing ACCESS_TOKEN_PAYLOAD_UPDATED event"),h.config.onHandleEvent({action:"ACCESS_TOKEN_PAYLOAD_UPDATED",userContext:{}})}function I(e){return n(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,h.recipeImpl.getInvalidClaimsFromResponse({response:e,userContext:{}})];case 1:return(t=n.sent())&&h.config.onHandleEvent({action:"API_INVALID_CLAIM",claimValidationErrors:t,userContext:{}}),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}))}function S(e){return n(this,void 0,void 0,(function(){var t,n,o;return r(this,(function(r){switch(r.label){case 0:return(0,c.logDebugMessage)("getLocalSessionState: called"),[4,P(p)];case 1:return t=r.sent(),[4,f.doesTokenExists()];case 2:return r.sent()&&void 0!==t?((0,c.logDebugMessage)("getLocalSessionState: returning EXISTS since both frontToken and lastAccessTokenUpdate exists"),[2,{status:"EXISTS",lastAccessTokenUpdate:t}]):[3,3];case 3:return t?((0,c.logDebugMessage)("getLocalSessionState: returning NOT_EXISTS since frontToken was cleared but lastAccessTokenUpdate exists"),[2,{status:"NOT_EXISTS"}]):[3,4];case 4:return n={status:"MAY_EXIST"},e?((0,c.logDebugMessage)("getLocalSessionState: trying to refresh"),[4,y(n)]):[3,7];case 5:return"RETRY"!==(o=r.sent()).result?((0,c.logDebugMessage)("getLocalSessionState: return NOT_EXISTS in case error from backend"+o.result),[2,{status:"NOT_EXISTS"}]):((0,c.logDebugMessage)("getLocalSessionState: Retrying post refresh"),[4,S(e)]);case 6:return[2,r.sent()];case 7:return(0,c.logDebugMessage)("getLocalSessionState: returning: "+n.status),[2,n]}}))}))}function k(e){switch(e){case"access":return v;case"refresh":return g}}function T(e,t){var n=k(e);return""!==t?((0,c.logDebugMessage)("setToken: saved ".concat(e," token into cookies")),R(n,t,Date.now()+31536e5)):((0,c.logDebugMessage)("setToken: cleared ".concat(e," token from cookies")),R(n,t,0))}function R(e,t,n){var r="Fri, 31 Dec 9999 23:59:59 GMT";n!==Number.MAX_SAFE_INTEGER&&(r=new Date(n).toUTCString());var o=h.config.sessionTokenFrontendDomain;return"localhost"===o||o===a.default.getReferenceOrThrow().windowHandler.location.getHostName()?i.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(e,"=").concat(t,";expires=").concat(r,";path=/;samesite=").concat(h.config.isInIframe?"none;secure":"lax")):i.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(e,"=").concat(t,";expires=").concat(r,";domain=").concat(o,";path=/;samesite=").concat(h.config.isInIframe?"none;secure":"lax"))}function _(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,P(k(e))]}))}))}function P(e){return n(this,void 0,void 0,(function(){var t,n,o,s;return r(this,(function(r){switch(r.label){case 0:return n="; ",[4,i.default.getReferenceOrThrow().cookieHandler.getCookie()];case 1:return t=n+r.sent(),(o=t.split("; "+e+"=")).length>=2&&void 0!==(s=o.pop())?[2,s.split(";").shift()]:[2,void 0]}}))}))}function A(e,t){return void 0===t&&(t=!1),n(this,void 0,void 0,(function(){var n,o;return r(this,(function(r){switch(r.label){case 0:return(0,c.logDebugMessage)("setTokenHeaders: adding existing tokens as header"),[4,_("access")];case 1:return n=r.sent(),[4,_("refresh")];case 2:return o=r.sent(),!t&&void 0===n||void 0===o?(0,c.logDebugMessage)("setAuthorizationHeaderIfRequired: token for header based auth not found"):e.has("Authorization")?(0,c.logDebugMessage)("setAuthorizationHeaderIfRequired: Authorization header defined by the user, not adding"):((0,c.logDebugMessage)("setAuthorizationHeaderIfRequired: added authorization header"),e.set("Authorization","Bearer ".concat(t?o:n))),[2]}}))}))}function x(t){return n(this,void 0,void 0,(function(){var n,o,s,i,a;return r(this,(function(r){switch(r.label){case 0:return(0,c.logDebugMessage)("saveTokensFromHeaders: Saving updated tokens from the response headers"),null===(n=t.headers.get("st-refresh-token"))?[3,2]:((0,c.logDebugMessage)("saveTokensFromHeaders: saving new refresh token"),[4,T("refresh",n)]);case 1:r.sent(),r.label=2;case 2:return null===(o=t.headers.get("st-access-token"))?[3,4]:((0,c.logDebugMessage)("saveTokensFromHeaders: saving new access token"),[4,T("access",o)]);case 3:r.sent(),r.label=4;case 4:return null===(s=t.headers.get("front-token"))?[3,6]:((0,c.logDebugMessage)("saveTokensFromHeaders: Setting sFrontToken: "+s),[4,f.setItem(s)]);case 5:r.sent(),(0,e.updateClockSkewUsingFrontToken)({frontToken:s,responseHeaders:t.headers}),r.label=6;case 6:return null===(i=t.headers.get("anti-csrf"))?[3,9]:[4,S(!0)];case 7:return"EXISTS"!==(a=r.sent()).status?[3,9]:((0,c.logDebugMessage)("saveTokensFromHeaders: Setting anti-csrf token"),[4,d.setItem(a.lastAccessTokenUpdate,i)]);case 8:r.sent(),r.label=9;case 9:return[2]}}))}))}function O(){return n(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return(0,c.logDebugMessage)("saveLastAccessTokenUpdate: called"),e=Date.now().toString(),(0,c.logDebugMessage)("saveLastAccessTokenUpdate: setting "+e),[4,R(p,e,Number.MAX_SAFE_INTEGER)];case 1:return t.sent(),[4,R("sIRTFrontend","",0)];case 2:return t.sent(),[2]}}))}))}function E(){return n(this,void 0,void 0,(function(){function e(){return n(this,void 0,void 0,(function(){var e,t,n,o,s;return r(this,(function(r){switch(r.label){case 0:return t="; ",[4,i.default.getReferenceOrThrow().cookieHandler.getCookie()];case 1:return e=t+r.sent(),(n=e.split("; "+b+"=")).length>=2&&void 0!==(o=n.pop())?void 0===(s=o.split(";").shift())?[2,null]:[2,s]:[2,null]}}))}))}var t;return r(this,(function(n){switch(n.label){case 0:return(0,c.logDebugMessage)("getAntiCSRFToken: called"),[4,S(!0)];case 1:return"EXISTS"!==n.sent().status?((0,c.logDebugMessage)("getAntiCSRFToken: Returning because local session state != EXISTS"),[2,null]):[4,e()];case 2:return t=n.sent(),(0,c.logDebugMessage)("getAntiCSRFToken: returning: "+t),[2,t]}}))}))}function C(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return(0,c.logDebugMessage)("setAntiCSRF: called: "+e),void 0===e?[3,2]:[4,R(b,e,Number.MAX_SAFE_INTEGER)];case 1:return t.sent(),[3,4];case 2:return[4,R(b,"",0)];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))}function D(){return n(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return(0,c.logDebugMessage)("getFrontTokenFromCookie: called"),[4,P(m)];case 1:return[2,void 0===(e=t.sent())?null:e]}}))}))}function M(e){return JSON.parse(decodeURIComponent(escape(atob(e))))}function U(){return n(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return(0,c.logDebugMessage)("getFrontToken: called"),[4,S(!0)];case 1:return"EXISTS"!==t.sent().status?((0,c.logDebugMessage)("getFrontToken: Returning because sIRTFrontend != EXISTS"),[2,null]):[4,D()];case 2:return e=t.sent(),(0,c.logDebugMessage)("getFrontToken: returning: "+e),[2,e]}}))}))}function H(e){return n(this,void 0,void 0,(function(){var t,n,o;return r(this,(function(r){switch(r.label){case 0:return(0,c.logDebugMessage)("setFrontToken: called"),[4,D()];case 1:return null!==(t=r.sent())&&void 0!==e&&(n=M(t).up,o=M(e).up,JSON.stringify(n)!==JSON.stringify(o)&&w()),void 0!==e?[3,3]:[4,R(m,"",0)];case 2:return r.sent(),[3,5];case 3:return[4,R(m,e,Number.MAX_SAFE_INTEGER)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))}function F(e,t,n){if(null!=n){var r="remove"!==n;(0,c.logDebugMessage)("fireSessionUpdateEventsIfNecessary wasLoggedIn: ".concat(e," frontTokenExistsAfter: ").concat(r," status: ").concat(t)),e?r||(t===h.config.sessionExpiredStatusCode?((0,c.logDebugMessage)("onUnauthorisedResponse: firing UNAUTHORISED event"),h.config.onHandleEvent({action:"UNAUTHORISED",sessionExpiredOrRevoked:!0,userContext:{}})):((0,c.logDebugMessage)("onUnauthorisedResponse: firing SIGN_OUT event"),h.config.onHandleEvent({action:"SIGN_OUT",userContext:{}}))):r&&((0,c.logDebugMessage)("onUnauthorisedResponse: firing SESSION_CREATED event"),h.config.onHandleEvent({action:"SESSION_CREATED",userContext:{}}))}else(0,c.logDebugMessage)("fireSessionUpdateEventsIfNecessary returning early because the front token was not updated")}e.onUnauthorisedResponse=y,e.onTokenUpdate=w,e.onInvalidClaimResponse=I,e.getLocalSessionState=S,e.getStorageNameForToken=k,e.setToken=T,e.getTokenForHeaderAuth=_,e.saveLastAccessTokenUpdate=O,e.setAntiCSRF=C,e.getFrontToken=U,e.setFrontToken=H,e.fireSessionUpdateEventsIfNecessary=F;e.updateClockSkewUsingFrontToken=function(e){var t=e.frontToken,n=e.responseHeaders;if((0,c.logDebugMessage)("updateClockSkewUsingFrontToken: frontToken: "+t),null!=t&&"remove"!==t){var r=M(t),o=h.recipeImpl.calculateClockSkewInMillis({accessTokenPayload:r.up,responseHeaders:n});l.default.getReferenceOrThrow().dateProvider.setClientClockSkewInMillis(o),(0,c.logDebugMessage)("updateClockSkewUsingFrontToken: Client clock synchronized successfully")}else(0,c.logDebugMessage)("updateClockSkewUsingFrontToken: the access token payload wasn't updated or is being removed, skipping clock skew update")}}(Oe)),Oe}var it,at={};function ut(){if(it)return at;it=1,Object.defineProperty(at,"__esModule",{value:!0}),at.SessionClaimValidatorStore=void 0;var e=function(){function e(){}return e.claimValidatorsAddedByOtherRecipes=[],e.addClaimValidatorFromOtherRecipe=function(t){e.claimValidatorsAddedByOtherRecipes.push(t)},e.getClaimValidatorsAddedByOtherRecipes=function(){return e.claimValidatorsAddedByOtherRecipes},e}();return at.SessionClaimValidatorStore=e,at.default=e,at}Object.defineProperty(we,"__esModule",{value:!0}),we.getGlobalClaimValidators=void 0;var ct=Ae(),lt=st(),dt=ut();we.getGlobalClaimValidators=function(e,t){var n=(0,ct.getNormalisedUserContext)(t),r=dt.default.getClaimValidatorsAddedByOtherRecipes(),o=lt.default.recipeImpl.getGlobalClaimValidators({claimValidatorsAddedByOtherRecipes:r,userContext:n});return void 0!==e?e(o,n):o},function(e){e.__esModule=!0,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(we)}(ye),Object.defineProperty(oe,"__esModule",{value:!0}),oe.normaliseUser=oe.normaliseUserResponse=oe.getGlobalClaimValidators=oe.getHashFromLocation=oe.getNormalisedUserContext=oe.checkForSSRErrorAndAppendIfNeeded=oe.getAllQueryParams=oe.getQueryParams=oe.isTest=oe.normaliseInputAppInfoOrThrowError=oe.appendQueryParamsToURL=void 0;var ft=se,ht=de,pt=fe,gt=ge,vt=ye;function bt(e,t){if("loginMethods"in t)return t;var n=void 0!==t.email?[t.email]:[],r=void 0!==t.phoneNumber?[t.phoneNumber]:[],o=void 0!==t.thirdParty?[t.thirdParty]:[];return{id:t.id,emails:n,phoneNumbers:r,thirdParty:o,isPrimaryUser:!1,tenantIds:t.tenantIds,timeJoined:t.timeJoined,loginMethods:[{recipeId:e,recipeUserId:t.id,timeJoined:t.timeJoined,tenantIds:t.tenantIds,email:t.email,phoneNumber:t.email}]}}oe.appendQueryParamsToURL=function(e,t){if(void 0===t)return e;try{var n=new URL(e);return Object.entries(t).forEach((function(e){var t=e[0],r=e[1];n.searchParams.set(t,r)})),n.href}catch(n){var r=e.startsWith("/")?"http:localhost":"http://localhost/",o=new URL("".concat(r).concat(e));return Object.entries(t).forEach((function(e){var t=e[0],n=e[1];o.searchParams.set(t,n)})),"".concat(o.pathname).concat(o.search)}},oe.normaliseInputAppInfoOrThrowError=function(e){if(void 0===e)throw new Error("Please provide the appInfo object when calling supertokens.init");if(void 0===e.apiDomain)throw new Error("Please provide your apiDomain inside the appInfo object when calling supertokens.init");if(void 0===e.appName)throw new Error("Please provide your appName inside the appInfo object when calling supertokens.init");var t,n,r=new gt.default("");return void 0!==e.apiGatewayPath&&(r=new gt.default(e.apiGatewayPath)),{appName:e.appName,apiDomain:new pt.default(e.apiDomain),apiBasePath:r.appendPath((t=ht.DEFAULT_API_BASE_PATH,n=e.apiBasePath,void 0!==n?new gt.default(n):new gt.default(t)))}},oe.isTest=function(){try{return"testing"===process.env.TEST_MODE}catch(e){return!1}},oe.getQueryParams=function(e){var t=new URLSearchParams(ft.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getSearch()).get(e);if(null!==t)return t},oe.getAllQueryParams=function(){return new URLSearchParams(ft.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getSearch())},oe.checkForSSRErrorAndAppendIfNeeded=function(e){return"undefined"==typeof window&&(e+=ht.SSR_ERROR),e},oe.getNormalisedUserContext=function(e){return void 0===e?{}:e},oe.getHashFromLocation=function(){return ft.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHash().substring(1)},oe.getGlobalClaimValidators=function(e){var t=e.overrideGlobalClaimValidators,n=e.userContext;return(0,vt.getGlobalClaimValidators)(t,n)},oe.normaliseUserResponse=function(e,t){return"createdNewRecipeUser"in t?t:{createdNewRecipeUser:t.createdNewUser,user:bt(e,t.user)}},oe.normaliseUser=bt;var mt={},yt={};Object.defineProperty(yt,"__esModule",{value:!0});var wt=function(e){this.config=e};yt.default=wt;var It,St,kt={},Tt={},Rt={},_t={},Pt={};function At(){if(It)return Pt;It=1;var e=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},t=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};function n(e,t,n,r,o){return e.config=t,e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}return Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.createAxiosErrorFromAxiosResp=Pt.createAxiosErrorFromFetchResp=void 0,Pt.createAxiosErrorFromFetchResp=function(r){return e(this,void 0,void 0,(function(){var e,o,s,i;return t(this,(function(t){switch(t.label){case 0:if(e={url:r.url,headers:r.headers},null!==(o=r.headers.get("content-type")))return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.text()];case 2:return s=t.sent(),[3,4];case 3:return t.sent(),s="",[3,4];case 4:return[3,11];case 5:return o.includes("application/json")?[4,r.json()]:[3,7];case 6:return s=t.sent(),[3,11];case 7:return o.includes("text/")?[4,r.text()]:[3,9];case 8:return s=t.sent(),[3,11];case 9:return[4,r.blob()];case 10:s=t.sent(),t.label=11;case 11:return i={data:s,status:r.status,statusText:r.statusText,headers:r.headers,config:e,request:void 0},[2,n(new Error("Request failed with status code "+r.status),e,0,void 0,i)]}}))}))},Pt.createAxiosErrorFromAxiosResp=function(r){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,n(new Error("Request failed with status code "+r.status),r.config,0,r.request,r)]}))}))},Pt}function xt(){if(St)return _t;St=1;var e=Y&&Y.__assign||function(){return e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},e.apply(this,arguments)},t=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},n=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(_t,"__esModule",{value:!0}),_t.responseErrorInterceptor=_t.responseInterceptor=_t.interceptorFunctionRequestFulfilled=void 0;var r=At(),o=st(),s=Ce(),i=le(),a=$e();function u(e){var t=void 0===e.url?"":e.url,n=e.baseURL;return void 0!==n&&(t="/"===t.charAt(0)&&"/"===n.charAt(n.length-1)?n+t.substr(1):"/"!==t.charAt(0)&&"/"!==n.charAt(n.length-1)?n+"/"+t:n+t),t}_t.interceptorFunctionRequestFulfilled=function(r){return t(this,void 0,void 0,(function(){var t,c,d,h,p,g;return n(this,(function(n){switch(n.label){case 0:(0,a.logDebugMessage)("interceptorFunctionRequestFulfilled: started axios interception"),t=u(r),c=!1;try{c="string"==typeof t&&!o.default.recipeImpl.shouldDoInterceptionBasedOnUrl(t,o.default.config.apiDomain,o.default.config.sessionTokenBackendDomain)}catch(e){if("Please provide a valid domain name"!==e.message)throw e;(0,a.logDebugMessage)("interceptorFunctionRequestFulfilled: Trying shouldDoInterceptionBasedOnUrl with location.origin"),c=!o.default.recipeImpl.shouldDoInterceptionBasedOnUrl(i.default.getReferenceOrThrow().windowHandler.location.getOrigin(),o.default.config.apiDomain,o.default.config.sessionTokenBackendDomain)}return(0,a.logDebugMessage)("interceptorFunctionRequestFulfilled: Value of doNotDoInterception: "+c),c?((0,a.logDebugMessage)("interceptorFunctionRequestFulfilled: Returning config unchanged"),[2,r]):((0,a.logDebugMessage)("interceptorFunctionRequestFulfilled: Modifying config"),s.ProcessState.getInstance().addState(s.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),[4,(0,o.getLocalSessionState)(!0)]);case 1:return d=n.sent(),h=r,"EXISTS"!==d.status?[3,3]:[4,o.AntiCsrfToken.getToken(d.lastAccessTokenUpdate)];case 2:void 0!==(p=n.sent())&&((0,a.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding anti-csrf token to request"),h=e(e({},h),{headers:void 0===h?{"anti-csrf":p}:e(e({},h.headers),{"anti-csrf":p})})),n.label=3;case 3:return o.default.config.autoAddCredentials&&void 0===h.withCredentials&&((0,a.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding credentials include"),h=e(e({},h),{withCredentials:!0})),(0,a.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding rid header: anti-csrf (it may be overriden by the user's provided rid)"),h=e(e({},h),{headers:void 0===h?{rid:"anti-csrf"}:e({rid:"anti-csrf"},h.headers)}),g=o.default.config.tokenTransferMethod,(0,a.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding st-auth-mode header: "+g),h.headers["st-auth-mode"]=g,[4,f(h)];case 4:return[4,l(h=n.sent())];case 5:return n.sent(),(0,a.logDebugMessage)("interceptorFunctionRequestFulfilled: returning modified config"),[2,h]}}))}))},_t.responseInterceptor=function(e){var r=this;return function(l){return t(r,void 0,void 0,(function(){var t,r,f,h,p;return n(this,(function(n){switch(n.label){case 0:t=!1,n.label=1;case 1:if(n.trys.push([1,,8,14]),!o.default.initCalled)throw new Error("init function not called");(0,a.logDebugMessage)("responseInterceptor: started"),(0,a.logDebugMessage)("responseInterceptor: already intercepted: "+l.headers["x-supertokens-xhr-intercepted"]),r=u(l.config);try{t="string"==typeof r&&!o.default.recipeImpl.shouldDoInterceptionBasedOnUrl(r,o.default.config.apiDomain,o.default.config.sessionTokenBackendDomain)||!!l.headers["x-supertokens-xhr-intercepted"]}catch(e){if("Please provide a valid domain name"!==e.message)throw e;(0,a.logDebugMessage)("responseInterceptor: Trying shouldDoInterceptionBasedOnUrl with location.origin"),t=!o.default.recipeImpl.shouldDoInterceptionBasedOnUrl(i.default.getReferenceOrThrow().windowHandler.location.getOrigin(),o.default.config.apiDomain,o.default.config.sessionTokenBackendDomain)||!!l.headers["x-supertokens-xhr-intercepted"]}return(0,a.logDebugMessage)("responseInterceptor: Value of doNotDoInterception: "+t),t?((0,a.logDebugMessage)("responseInterceptor: Returning without interception"),[2,l]):((0,a.logDebugMessage)("responseInterceptor: Interception started"),s.ProcessState.getInstance().addState(s.PROCESS_STATE.CALLING_INTERCEPTION_RESPONSE),[4,(0,o.getLocalSessionState)(!1)]);case 2:return f=n.sent(),[4,d(l)];case 3:return n.sent(),(0,o.fireSessionUpdateEventsIfNecessary)("EXISTS"===f.status,l.status,l.headers["front-token"]),l.status!==o.default.config.sessionExpiredStatusCode?[3,4]:((0,a.logDebugMessage)("responseInterceptor: Status code is: "+l.status),h=l.config,[2,c.doRequest((function(t){return e(t)}),h,r,l,void 0,!0)]);case 4:return l.status!==o.default.config.invalidClaimStatusCode?[3,6]:[4,(0,o.onInvalidClaimResponse)(l)];case 5:n.sent(),n.label=6;case 6:return[2,l];case 7:return[3,14];case 8:return(p=!t)?[4,(0,o.getLocalSessionState)(!0)]:[3,10];case 9:p=!("EXISTS"===n.sent().status),n.label=10;case 10:return p?((0,a.logDebugMessage)("responseInterceptor: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,o.AntiCsrfToken.removeToken()]):[3,13];case 11:return n.sent(),[4,o.FrontToken.removeToken()];case 12:n.sent(),n.label=13;case 13:return[7];case 14:return[2]}}))}))}},_t.responseErrorInterceptor=function(e){var r=this;return function(s){return t(r,void 0,void 0,(function(){var t;return n(this,(function(n){switch(n.label){case 0:if((0,a.logDebugMessage)("responseErrorInterceptor: called"),(0,a.logDebugMessage)("responseErrorInterceptor: already intercepted: "+(s.response&&s.response.headers["x-supertokens-xhr-intercepted"])),s.response.headers["x-supertokens-xhr-intercepted"])throw s;return void 0===s.response||s.response.status!==o.default.config.sessionExpiredStatusCode?[3,1]:((0,a.logDebugMessage)("responseErrorInterceptor: Status code is: "+s.response.status),t=s.config,[2,c.doRequest((function(t){return e(t)}),t,u(t),void 0,s,!0)]);case 1:return void 0===s.response||s.response.status!==o.default.config.invalidClaimStatusCode?[3,3]:[4,(0,o.onInvalidClaimResponse)(s.response)];case 2:n.sent(),n.label=3;case 3:throw s}}))}))}};var c=function(){function s(){}var u;return u=s,s.doRequest=function(s,c,h,p,g,v){return void 0===v&&(v=!1),t(void 0,void 0,void 0,(function(){var t,b,m,y,w,I,S,k,T,R,_,P,A,x;return n(u,(function(n){switch(n.label){case 0:if(!o.default.initCalled)throw Error("init function not called");(0,a.logDebugMessage)("doRequest: called"),t=!1;try{t="string"==typeof h&&!o.default.recipeImpl.shouldDoInterceptionBasedOnUrl(h,o.default.config.apiDomain,o.default.config.sessionTokenBackendDomain)&&v}catch(e){if("Please provide a valid domain name"!==e.message)throw e;(0,a.logDebugMessage)("doRequest: Trying shouldDoInterceptionBasedOnUrl with location.origin"),t=!o.default.recipeImpl.shouldDoInterceptionBasedOnUrl(i.default.getReferenceOrThrow().windowHandler.location.getOrigin(),o.default.config.apiDomain,o.default.config.sessionTokenBackendDomain)&&v}if((0,a.logDebugMessage)("doRequest: Value of doNotDoInterception: "+t),!t)return[3,2];if((0,a.logDebugMessage)("doRequest: Returning without interception"),void 0!==g)throw g;return void 0!==p?[2,p]:[4,s(c)];case 1:return[2,n.sent()];case 2:return(0,a.logDebugMessage)("doRequest: Interception started"),[4,f(c)];case 3:c=n.sent(),n.label=4;case 4:n.trys.push([4,,40,45]),b=void 0,n.label=5;case 5:return[4,(0,o.getLocalSessionState)(!0)];case 6:return m=n.sent(),y=c,"EXISTS"!==m.status?[3,8]:[4,o.AntiCsrfToken.getToken(m.lastAccessTokenUpdate)];case 7:void 0!==(w=n.sent())&&((0,a.logDebugMessage)("doRequest: Adding anti-csrf token to request"),y=e(e({},y),{headers:void 0===y?{"anti-csrf":w}:e(e({},y.headers),{"anti-csrf":w})})),n.label=8;case 8:return o.default.config.autoAddCredentials&&void 0===y.withCredentials&&((0,a.logDebugMessage)("doRequest: Adding credentials include"),y=e(e({},y),{withCredentials:!0})),(0,a.logDebugMessage)("doRequest: Adding rid header: anti-csrf (May get overriden by user's rid)"),y=e(e({},y),{headers:void 0===y?{rid:"anti-csrf"}:e({rid:"anti-csrf"},y.headers)}),I=o.default.config.tokenTransferMethod,(0,a.logDebugMessage)("doRequest: Adding st-auth-mode header: "+I),y.headers["st-auth-mode"]=I,[4,l(y)];case 9:n.sent(),n.label=10;case 10:if(n.trys.push([10,25,,38]),S=g,k=p,g=void 0,p=void 0,void 0!==S)throw(0,a.logDebugMessage)("doRequest: Not making call because localPrevError is not undefined"),S;return void 0!==k?(0,a.logDebugMessage)("doRequest: Not making call because localPrevResponse is not undefined"):(0,a.logDebugMessage)("doRequest: Making user's http call"),void 0!==k?[3,12]:[4,s(y)];case 11:return T=n.sent(),[3,13];case 12:T=k,n.label=13;case 13:return P=T,(0,a.logDebugMessage)("doRequest: User's http call ended"),[4,d(P)];case 14:return n.sent(),(0,o.fireSessionUpdateEventsIfNecessary)("EXISTS"===m.status,P.status,P.headers["front-token"]),P.status!==o.default.config.sessionExpiredStatusCode?[3,21]:((0,a.logDebugMessage)("doRequest: Status code is: "+P.status),[4,(0,o.onUnauthorisedResponse)(m)]);case 15:return"RETRY"===(A=n.sent()).result?[3,20]:((0,a.logDebugMessage)("doRequest: Not retrying original request"),A.error?[4,(0,r.createAxiosErrorFromFetchResp)(A.error)]:[3,17]);case 16:return R=n.sent(),[3,19];case 17:return[4,(0,r.createAxiosErrorFromAxiosResp)(P)];case 18:R=n.sent(),n.label=19;case 19:return b=R,[3,39];case 20:return(0,a.logDebugMessage)("doRequest: Retrying original request"),[3,24];case 21:return P.status!==o.default.config.invalidClaimStatusCode?[3,23]:[4,(0,o.onInvalidClaimResponse)(P)];case 22:n.sent(),n.label=23;case 23:return[2,P];case 24:return[3,38];case 25:return _=n.sent(),void 0===(P=_.response)?[3,36]:[4,d(P)];case 26:return n.sent(),(0,o.fireSessionUpdateEventsIfNecessary)("EXISTS"===m.status,P.status,P.headers["front-token"]),P.status!==o.default.config.sessionExpiredStatusCode?[3,32]:((0,a.logDebugMessage)("doRequest: Status code is: "+P.status),[4,(0,o.onUnauthorisedResponse)(m)]);case 27:return"RETRY"===(A=n.sent()).result?[3,31]:((0,a.logDebugMessage)("doRequest: Not retrying original request"),void 0===A.error?[3,29]:[4,(0,r.createAxiosErrorFromFetchResp)(A.error)]);case 28:return x=n.sent(),[3,30];case 29:x=_,n.label=30;case 30:return b=x,[3,39];case 31:return(0,a.logDebugMessage)("doRequest: Retrying original request"),[3,35];case 32:return P.status!==o.default.config.invalidClaimStatusCode?[3,34]:[4,(0,o.onInvalidClaimResponse)(P)];case 33:n.sent(),n.label=34;case 34:throw _;case 35:return[3,37];case 36:throw _;case 37:return[3,38];case 38:return[3,5];case 39:throw b;case 40:return[4,(0,o.getLocalSessionState)(!1)];case 41:return"NOT_EXISTS"!==n.sent().status?[3,44]:((0,a.logDebugMessage)("doRequest: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,o.AntiCsrfToken.removeToken()]);case 42:return n.sent(),[4,o.FrontToken.removeToken()];case 43:n.sent(),n.label=44;case 44:return[7];case 45:return[2]}}))}))},s}();function l(r){return t(this,void 0,void 0,(function(){var t,s;return n(this,(function(n){switch(n.label){case 0:return void 0===r.headers&&(r.headers={}),(0,a.logDebugMessage)("setAuthorizationHeaderIfRequired: adding existing tokens as header"),[4,(0,o.getTokenForHeaderAuth)("access")];case 1:return t=n.sent(),[4,(0,o.getTokenForHeaderAuth)("refresh")];case 2:return s=n.sent(),void 0!==t&&void 0!==s?void 0!==r.headers.Authorization||void 0!==r.headers.authorization?(0,a.logDebugMessage)("setAuthorizationHeaderIfRequired: Authorization header defined by the user, not adding"):((0,a.logDebugMessage)("setAuthorizationHeaderIfRequired: added authorization header"),r.headers=e(e({},r.headers),{Authorization:"Bearer ".concat(t)}),r.__supertokensAddedAuthHeader=!0):(0,a.logDebugMessage)("setAuthorizationHeaderIfRequired: token for header based auth not found"),[2]}}))}))}function d(e){return t(this,void 0,void 0,(function(){var t,r,s,i,u,c;return n(this,(function(n){switch(n.label){case 0:return(0,a.logDebugMessage)("saveTokensFromHeaders: Saving updated tokens from the response"),void 0===(t=e.headers["st-refresh-token"])?[3,2]:((0,a.logDebugMessage)("saveTokensFromHeaders: saving new refresh token"),[4,(0,o.setToken)("refresh",t)]);case 1:n.sent(),n.label=2;case 2:return void 0===(r=e.headers["st-access-token"])?[3,4]:((0,a.logDebugMessage)("saveTokensFromHeaders: saving new access token"),[4,(0,o.setToken)("access",r)]);case 3:n.sent(),n.label=4;case 4:return void 0===(s=e.headers["front-token"])?[3,6]:((0,a.logDebugMessage)("doRequest: Setting sFrontToken: "+s),[4,o.FrontToken.setItem(s)]);case 5:n.sent(),i=new Headers,Object.entries(e.headers).forEach((function(e){var t=e[0],n=e[1];Array.isArray(n)?n.forEach((function(e){return i.append(t,e)})):i.append(t,n)})),(0,o.updateClockSkewUsingFrontToken)({frontToken:s,responseHeaders:i}),n.label=6;case 6:return void 0===(u=e.headers["anti-csrf"])?[3,9]:[4,(0,o.getLocalSessionState)(!0)];case 7:return"EXISTS"!==(c=n.sent()).status?[3,9]:((0,a.logDebugMessage)("doRequest: Setting anti-csrf token"),[4,o.AntiCsrfToken.setItem(c.lastAccessTokenUpdate,u)]);case 8:n.sent(),n.label=9;case 9:return[2]}}))}))}function f(r){return t(this,void 0,void 0,(function(){var t,s,i,u;return n(this,(function(n){switch(n.label){case 0:return[4,(0,o.getTokenForHeaderAuth)("access")];case 1:return t=n.sent(),[4,(0,o.getTokenForHeaderAuth)("refresh")];case 2:return s=n.sent(),i=r.headers.Authorization||r.headers.authorization,void 0===t||void 0===s||i!=="Bearer ".concat(t)&&!("__supertokensAddedAuthHeader"in r)?[2,r]:((0,a.logDebugMessage)("removeAuthHeaderIfMatchesLocalToken: Removing Authorization from user provided headers because it contains our access token"),delete(u=e(e({},r),{headers:e({},r.headers)})).headers.authorization,delete u.headers.Authorization,[2,u])}}))}))}return _t.default=c,_t}var Ot,Et={};function Ct(){if(Ot)return Et;Ot=1;var e,t=Y&&Y.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(Et,"__esModule",{value:!0}),Et.STGeneralError=void 0;var n=function(e){function n(t){var n=e.call(this,t)||this;return n.isSuperTokensGeneralError=!0,n}return t(n,e),n.isThisError=function(e){return!0===e.isSuperTokensGeneralError},n}(Error);return Et.STGeneralError=n,Et}var Dt,Mt,Ut={};function Ht(){if(Dt)return Ut;Dt=1;var e=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},t=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.addInterceptorsToXMLHttpRequest=void 0;var n=st(),r=$e(),o=le(),s=Ce(),i=["readystatechange","abort","error","load","loadend","loadstart","progress","timeout"];function a(n){return e(this,void 0,void 0,(function(){var e,r,o,s,i;return t(this,(function(t){switch(t.label){case 0:if(e=n.headers.get("content-type"),r="",o="text",null!==e)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,n.text()];case 2:return r=t.sent(),[3,4];case 3:return t.sent(),r="",[3,4];case 4:return[3,9];case 5:return e.includes("application/json")?(o="json",i=(s=JSON).stringify,[4,n.json()]):[3,7];case 6:return r=i.apply(s,[t.sent()]),[3,9];case 7:return e.includes("text/")?[4,n.text()]:[3,9];case 8:r=t.sent(),t.label=9;case 9:return[2,{status:n.status,responseText:r,statusText:n.statusText,responseType:o,headers:n.headers}]}}))}))}function u(o,s){return e(this,void 0,void 0,(function(){var e,i;return t(this,(function(t){switch(t.label){case 0:return(0,r.logDebugMessage)("setAuthorizationHeaderIfRequired: adding existing tokens as header"),[4,(0,n.getTokenForHeaderAuth)("access")];case 1:return e=t.sent(),[4,(0,n.getTokenForHeaderAuth)("refresh")];case 2:return i=t.sent(),void 0!==e&&void 0!==i?s.some((function(e){return"authorization"===e.name.toLowerCase()}))?(0,r.logDebugMessage)("setAuthorizationHeaderIfRequired: Authorization header defined by the user, not adding"):void 0!==e&&((0,r.logDebugMessage)("setAuthorizationHeaderIfRequired: added authorization header"),o.setRequestHeader("Authorization","Bearer ".concat(e))):(0,r.logDebugMessage)("setAuthorizationHeaderIfRequired: token for header based auth not found"),[2]}}))}))}function c(o){return e(this,void 0,void 0,(function(){var e,s,i,a,u;return t(this,(function(t){switch(t.label){case 0:return(0,r.logDebugMessage)("saveTokensFromHeaders: Saving updated tokens from the response"),null===(e=o.get("st-refresh-token"))?[3,2]:((0,r.logDebugMessage)("saveTokensFromHeaders: saving new refresh token"),[4,(0,n.setToken)("refresh",e)]);case 1:t.sent(),t.label=2;case 2:return null===(s=o.get("st-access-token"))?[3,4]:((0,r.logDebugMessage)("saveTokensFromHeaders: saving new access token"),[4,(0,n.setToken)("access",s)]);case 3:t.sent(),t.label=4;case 4:return null===(i=o.get("front-token"))?[3,6]:((0,r.logDebugMessage)("saveTokensFromHeaders: Setting sFrontToken: "+i),[4,n.FrontToken.setItem(i)]);case 5:t.sent(),(0,n.updateClockSkewUsingFrontToken)({frontToken:i,responseHeaders:o}),t.label=6;case 6:return null===(a=o.get("anti-csrf"))?[3,9]:[4,(0,n.getLocalSessionState)(!0)];case 7:return"EXISTS"!==(u=t.sent()).status?[3,9]:((0,r.logDebugMessage)("saveTokensFromHeaders: Setting anti-csrf token"),[4,n.AntiCsrfToken.setItem(u.lastAccessTokenUpdate,a)]);case 8:t.sent(),t.label=9;case 9:return[2]}}))}))}return Ut.addInterceptorsToXMLHttpRequest=function(){var l=new Promise((function(e){return setTimeout(e,0)})),d=XMLHttpRequest;(0,r.logDebugMessage)("addInterceptorsToXMLHttpRequest called"),XMLHttpRequest=function(){var f=new d,h=l;function p(e){h=h.finally((function(){var t;return null===(t=e())||void 0===t?void 0:t.catch(console.error)}))}var g,v,b=this,m=[],y=[],w={},I=new Map,S="",k=!1,T=void 0;function R(e,t){var n=I.get(e);(0,r.logDebugMessage)("XHRInterceptor dispatching ".concat(t.type," to ").concat(n?n.size:0," listeners")),n&&Array.from(n).forEach((function(e){return e.apply(b,[t])}))}function _(){return e(this,void 0,void 0,(function(){var e,o;return t(this,(function(t){switch(t.label){case 0:if(void 0===T)throw new Error("Should never come here..");return(0,r.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: preRequestLSS "+T.status),[4,(0,n.onUnauthorisedResponse)(T)];case 1:if("RETRY"!==(e=t.sent()).result){if((0,r.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: Not retrying original request "+!!e.error),void 0!==e.error)throw e.error;return[2,!0]}return(0,r.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: Retrying original request"),o=new d,x(b,o,!0),m.forEach((function(e){e(o)})),O(o,v),[2,!1]}}))}))}function P(o){return e(this,void 0,void 0,(function(){var e,i,u,l;return t(this,(function(t){switch(t.label){case 0:if(k)return(0,r.logDebugMessage)("XHRInterceptor.handleResponse: Returning without interception"),[2,!0];t.label=1;case 1:t.trys.push([1,14,,18]),t.label=2;case 2:return t.trys.push([2,,8,13]),(0,r.logDebugMessage)("XHRInterceptor.handleResponse: Interception started"),s.ProcessState.getInstance().addState(s.PROCESS_STATE.CALLING_INTERCEPTION_RESPONSE),e=o.status,i=function(e){return new Headers(e.getAllResponseHeaders().split("\r\n").map((function(e){var t=e.indexOf(": ");return-1===t?["",""]:[e.slice(0,t),e.slice(t+2)]})).filter((function(e){return 0!==e[0].length})))}(o),[4,c(i)];case 3:return t.sent(),(0,n.fireSessionUpdateEventsIfNecessary)("EXISTS"===T.status,e,i.get("front-token")),e!==n.default.config.sessionExpiredStatusCode?[3,5]:((0,r.logDebugMessage)("responseInterceptor: Status code is: "+e),[4,_()]);case 4:return[2,t.sent()];case 5:return e!==n.default.config.invalidClaimStatusCode?[3,7]:[4,(0,n.onInvalidClaimResponse)({data:JSON.parse(o.responseText)})];case 6:t.sent(),t.label=7;case 7:return[2,!0];case 8:return(0,r.logDebugMessage)("XHRInterceptor.handleResponse: doFinallyCheck running"),[4,(0,n.getLocalSessionState)(!1)];case 9:return"EXISTS"===t.sent().status?[3,12]:((0,r.logDebugMessage)("XHRInterceptor.handleResponse: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,n.AntiCsrfToken.removeToken()]);case 10:return t.sent(),[4,n.FrontToken.removeToken()];case 11:t.sent(),t.label=12;case 12:return[7];case 13:return[3,18];case 14:return u=t.sent(),(0,r.logDebugMessage)("XHRInterceptor.handleResponse: caught error"),void 0===u.status?[3,16]:[4,a(u)];case 15:if(l=t.sent(),w.status=l.status,w.statusText=l.statusText,w.responseType=l.responseType,g=l.headers,"json"===l.responseType)try{w.response=JSON.parse(l.responseText)}catch(e){w.response=l.responseText}else w.response=l.responseText;return w.responseText=l.responseText,[3,17];case 16:R("error",new Event("error")),t.label=17;case 17:return[2,!0];case 18:return[2]}}))}))}b.onload=null,b.onreadystatechange=null,b.onloadend=null,b.addEventListener=function(e,t,n){var r=I.get(e);void 0===r&&(r=new Set,I.set(e,r)),r.add(t)},b.removeEventListener=function(e,t){var n=I.get(e);void 0===n&&(n=new Set,I.set(e,n)),n.delete(t)},b.open=function(e,t){(0,r.logDebugMessage)("XHRInterceptor.open called");var s=arguments;S=t;try{k="string"==typeof S&&!n.default.recipeImpl.shouldDoInterceptionBasedOnUrl(S,n.default.config.apiDomain,n.default.config.sessionTokenBackendDomain)||"string"!=typeof S&&!n.default.recipeImpl.shouldDoInterceptionBasedOnUrl(S.toString(),n.default.config.apiDomain,n.default.config.sessionTokenBackendDomain)}catch(e){if("Please provide a valid domain name"!==e.message)throw e;(0,r.logDebugMessage)("XHRInterceptor.open: Trying shouldDoInterceptionBasedOnUrl with location.origin"),k=!n.default.recipeImpl.shouldDoInterceptionBasedOnUrl(o.default.getReferenceOrThrow().windowHandler.location.getOrigin(),n.default.config.apiDomain,n.default.config.sessionTokenBackendDomain)}p((function(){m.push((function(e){e.open.apply(e,s)})),f.open.apply(f,s)}))},b.send=function(e){O(f,v=e)},b.setRequestHeader=function(o,s){var i=this;(0,r.logDebugMessage)("XHRInterceptor.setRequestHeader: Called with ".concat(o)),k?p((function(){return f.setRequestHeader(o,s)})):"anti-csrf"!==o&&p((function(){return e(i,void 0,void 0,(function(){var e,i;return t(this,(function(t){switch(t.label){case 0:return"authorization"!==o.toLowerCase()?[3,3]:((0,r.logDebugMessage)("XHRInterceptor.setRequestHeader: checking if user provided auth header matches local token"),[4,(0,n.getTokenForHeaderAuth)("access")]);case 1:return e=t.sent(),[4,(0,n.getTokenForHeaderAuth)("refresh")];case 2:if(i=t.sent(),void 0!==e&&void 0!==i&&s==="Bearer ".concat(e))return(0,r.logDebugMessage)("XHRInterceptor.setRequestHeader: skipping Authorization from user provided headers because it contains our access token"),[2];t.label=3;case 3:return m.push((function(e){e.setRequestHeader(o,s)})),y.push({name:o,value:s}),f.setRequestHeader(o,s),[2]}}))}))}))};var A=void 0;function x(e,t,n){var o,s=["load","loadend","readystatechange"];(0,r.logDebugMessage)("XHRInterceptor.setUpXHR called");for(var a=function(e){(0,r.logDebugMessage)("XHRInterceptor added listener for event ".concat(e)),t.addEventListener(e,(function(t){(0,r.logDebugMessage)("XHRInterceptor got event ".concat(e)),s.includes(e)||R(e,t)}))},u=0,c=i;u<c.length;u++){a(c[u])}if(t.onload=function(n){void 0===o&&(o=P(t)),o.then((function(t){t&&(e.onload&&e.onload(n),R("load",n))}))},t.onreadystatechange=function(n){t.readyState===d.DONE?(void 0===o&&(o=P(t)),o.then((function(t){t&&(e.onreadystatechange&&e.onreadystatechange(n),R("readystatechange",n))}))):(e.onreadystatechange&&e.onreadystatechange(n),R("readystatechange",n))},t.onloadend=function(n){void 0===o&&(o=P(t)),o.then((function(t){t&&(e.onloadend&&e.onloadend(n),R("loadend",n))}))},e.getAllResponseHeaders=function(){var e;return g?(e="",g.forEach((function(t,n){return e+="".concat(n,": ").concat(t,"\r\n")}))):e=t.getAllResponseHeaders(),e+"x-supertokens-xhr-intercepted: true\r\n"},e.getResponseHeader=function(e){return"x-supertokens-xhr-intercepted"===e?"true":g?g.get(e):t.getResponseHeader(e)},void 0===A)for(var l in A=[],t)l in e||A.push(l);for(var f=function(o){"function"==typeof t[o]?Object.defineProperty(e,o,{configurable:!0,value:function(){var e=arguments;return n||m.push((function(t){t[o].apply(t,e)})),t[o].apply(t,e)}}):Object.defineProperty(e,o,{configurable:!0,get:function(){return void 0!==w[o]?w[o]:t[o]},set:function(e){n||m.push((function(t){t[o]=e})),(0,r.logDebugMessage)("XHRInterceptor.set[".concat(o,"] = ").concat(e)),t[o]=e}})},h=0,p=A;h<p.length;h++){f(l=p[h])}}function O(o,i){var a=this;if((0,r.logDebugMessage)("XHRInterceptor.send: called"),(0,r.logDebugMessage)("XHRInterceptor.send: Value of doNotDoInterception: "+k),k)return(0,r.logDebugMessage)("XHRInterceptor.send: Returning without interception"),void p((function(){return o.send(i)}));(0,r.logDebugMessage)("XHRInterceptor.send: Interception started"),s.ProcessState.getInstance().addState(s.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),p((function(){return e(a,void 0,void 0,(function(){var e,s;return t(this,(function(t){switch(t.label){case 0:return[4,(0,n.getLocalSessionState)(!0)];case 1:return"EXISTS"!==(T=t.sent()).status?[3,3]:[4,n.AntiCsrfToken.getToken(T.lastAccessTokenUpdate)];case 2:void 0!==(e=t.sent())&&((0,r.logDebugMessage)("XHRInterceptor.send: Adding anti-csrf token to request"),o.setRequestHeader("anti-csrf",e)),t.label=3;case 3:return n.default.config.autoAddCredentials&&((0,r.logDebugMessage)("XHRInterceptor.send: Adding credentials include"),b.withCredentials=!0),y.some((function(e){return"rid"===e.name}))?(0,r.logDebugMessage)("XHRInterceptor.send: rid header was already there in request"):((0,r.logDebugMessage)("XHRInterceptor.send: Adding rid header: anti-csrf"),o.setRequestHeader("rid","anti-csrf")),s=n.default.config.tokenTransferMethod,y.some((function(e){return"st-auth-mode"===e.name}))?(0,r.logDebugMessage)("XHRInterceptor.send: st-auth-mode header was already there in request"):((0,r.logDebugMessage)("XHRInterceptor.send: Adding st-auth-mode header: "+s),o.setRequestHeader("st-auth-mode",s)),[4,u(o,y)];case 4:return t.sent(),(0,r.logDebugMessage)("XHRInterceptor.send: Making user's http call"),[2,o.send(i)]}}))}))}))}x(b,f,!1)},XMLHttpRequest.__interceptedBySuperTokens=!0,XMLHttpRequest.__original=d},Ut}function Ft(){if(Mt)return Rt;Mt=1;var e=Y&&Y.__assign||function(){return e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},e.apply(this,arguments)},t=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},n=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(Rt,"__esModule",{value:!0});var r=st(),o=xt(),s=Ue(),i=$e(),a=Ct(),u=Ht(),c=Ae(),l=ot();return Rt.default=function(d){return{addXMLHttpRequestInterceptor:function(e){(0,i.logDebugMessage)("addXMLHttpRequestInterceptorAndReturnModified: called"),(0,u.addInterceptorsToXMLHttpRequest)()},addFetchInterceptorsAndReturnModifiedFetch:function(o){return(0,i.logDebugMessage)("addFetchInterceptorsAndReturnModifiedFetch: called"),function(s,i){return t(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,r.default.doRequest((function(t){return o.originalFetch("object"==typeof s&&"clone"in s?s.clone():s,e({},t))}),i,s)];case 1:return[2,t.sent()]}}))}))}},addAxiosInterceptors:function(e){if((0,i.logDebugMessage)("addAxiosInterceptors: called"),XMLHttpRequest.__interceptedBySuperTokens)return console.warn("Not adding axios interceptor since XMLHttpRequest is already added. This is just a warning."),console.warn("Our axios and XMLHttpRequest interceptors cannot be used at the same time."),console.warn("Since XMLHttpRequest is added automatically and supports axios by default, you can just remove addAxiosInterceptors from your code."),console.warn("If you want to continue using our axios interceptor, you can override addXMLHttpRequestInterceptor with an empty function."),void(0,i.logDebugMessage)("addAxiosInterceptors: not adding, because XHR interceptors are already in place");for(var r=e.axiosInstance.interceptors.request,s=0;s<r.handlers.length;s++)if(r.handlers[s].fulfilled===o.interceptorFunctionRequestFulfilled)return void(0,i.logDebugMessage)("addAxiosInterceptors: not adding because already added on this instance");e.axiosInstance.interceptors.request.use(o.interceptorFunctionRequestFulfilled,(function(e){return t(this,void 0,void 0,(function(){return n(this,(function(t){throw e}))}))})),e.axiosInstance.interceptors.response.use((0,o.responseInterceptor)(e.axiosInstance),(0,o.responseErrorInterceptor)(e.axiosInstance))},getUserId:function(e){return t(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:return(0,i.logDebugMessage)("getUserId: called"),[4,r.FrontToken.getTokenInfo()];case 1:if(void 0===(e=t.sent()))throw new Error("No session exists");return(0,i.logDebugMessage)("getUserId: returning: "+e.uid),[2,e.uid]}}))}))},getAccessTokenPayloadSecurely:function(e){return t(this,void 0,void 0,(function(){var t;return n(this,(function(n){switch(n.label){case 0:return(0,i.logDebugMessage)("getAccessTokenPayloadSecurely: called"),[4,r.FrontToken.getTokenInfo()];case 1:if(void 0===(t=n.sent()))throw new Error("No session exists");return t.ate<l.default.getReferenceOrThrow().dateProvider.now()?((0,i.logDebugMessage)("getAccessTokenPayloadSecurely: access token expired. Refreshing session"),[4,r.default.attemptRefreshingSession()]):[3,5];case 2:return n.sent()?[4,this.getAccessTokenPayloadSecurely({userContext:e.userContext})]:[3,4];case 3:return[2,n.sent()];case 4:throw new Error("Could not refresh session");case 5:return(0,i.logDebugMessage)("getAccessTokenPayloadSecurely: returning: "+JSON.stringify(t.up)),[2,t.up]}}))}))},doesSessionExist:function(e){return t(this,void 0,void 0,(function(){var e,t;return n(this,(function(n){switch(n.label){case 0:return(0,i.logDebugMessage)("doesSessionExist: called"),[4,r.FrontToken.getTokenInfo()];case 1:return void 0===(e=n.sent())?((0,i.logDebugMessage)("doesSessionExist: access token does not exist locally"),[2,!1]):e.ate<l.default.getReferenceOrThrow().dateProvider.now()?((0,i.logDebugMessage)("doesSessionExist: access token expired. Refreshing session"),[4,(0,r.getLocalSessionState)(!1)]):[3,4];case 2:return t=n.sent(),[4,(0,r.onUnauthorisedResponse)(t)];case 3:return[2,"RETRY"===n.sent().result];case 4:return[2,!0]}}))}))},signOut:function(e){return t(this,void 0,void 0,(function(){var t,o,u,c;return n(this,(function(n){switch(n.label){case 0:return(0,i.logDebugMessage)("signOut: called"),[4,this.doesSessionExist(e)];case 1:return n.sent()?((0,i.logDebugMessage)("signOut: Calling refresh pre API hook"),[4,d.preAPIHook({action:"SIGN_OUT",requestInit:{method:"post",headers:{"fdi-version":s.supported_fdi.join(","),rid:r.default.rid}},url:r.default.signOutUrl,userContext:e.userContext})]):((0,i.logDebugMessage)("signOut: exiting early because session does not exist"),(0,i.logDebugMessage)("signOut: firing SIGN_OUT event"),d.onHandleEvent({action:"SIGN_OUT",userContext:e.userContext}),[2]);case 2:return t=n.sent(),(0,i.logDebugMessage)("signOut: Calling API"),[4,fetch(t.url,t.requestInit)];case 3:if(o=n.sent(),(0,i.logDebugMessage)("signOut: API ended"),(0,i.logDebugMessage)("signOut: API responded with status code: "+o.status),o.status===d.sessionExpiredStatusCode)return[2];if(o.status>=300)throw o;return[4,d.postAPIHook({action:"SIGN_OUT",requestInit:t.requestInit,url:t.url,fetchResponse:o.clone(),userContext:e.userContext})];case 4:return n.sent(),[4,o.clone().json()];case 5:if("GENERAL_ERROR"===(u=n.sent()).status)throw(0,i.logDebugMessage)("doRequest: Throwing general error"),c=void 0===u.message?"No Error Message Provided":u.message,new a.STGeneralError(c);return[2]}}))}))},getInvalidClaimsFromResponse:function(e){return t(this,void 0,void 0,(function(){var t;return n(this,(function(n){switch(n.label){case 0:return"body"in e.response?[4,e.response.clone().json()]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t="string"==typeof e.response.data?JSON.parse(e.response.data):e.response.data,n.label=3;case 3:return[2,t.claimValidationErrors]}}))}))},getGlobalClaimValidators:function(e){return e.claimValidatorsAddedByOtherRecipes},validateClaims:function(e){return t(this,void 0,void 0,(function(){var t,r,o,s,i,a,u,c,l;return n(this,(function(n){switch(n.label){case 0:return[4,this.getAccessTokenPayloadSecurely({userContext:e.userContext})];case 1:t=n.sent(),r=0,o=e.claimValidators,n.label=2;case 2:return r<o.length?[4,(c=o[r]).shouldRefresh(t,e.userContext)]:[3,10];case 3:if(!n.sent())return[3,9];n.label=4;case 4:return n.trys.push([4,6,,7]),[4,c.refresh(e.userContext)];case 5:return n.sent(),[3,7];case 6:return s=n.sent(),console.error("Encountered an error while refreshing validator ".concat(c.id),s),[3,7];case 7:return[4,this.getAccessTokenPayloadSecurely({userContext:e.userContext})];case 8:t=n.sent(),n.label=9;case 9:return r++,[3,2];case 10:i=[],a=0,u=e.claimValidators,n.label=11;case 11:return a<u.length?[4,(c=u[a]).validate(t,e.userContext)]:[3,14];case 12:(l=n.sent()).isValid||i.push({id:c.id,reason:l.reason}),n.label=13;case 13:return a++,[3,11];case 14:return[2,i]}}))}))},shouldDoInterceptionBasedOnUrl:function(e,t,n){if((0,i.logDebugMessage)("shouldDoInterceptionBasedOnUrl: toCheckUrl: "+e+" apiDomain: "+t+" sessionTokenBackendDomain: "+n),e.includes("superTokensDoNotDoInterception"))return!1;e=(0,c.normaliseURLDomainOrThrowError)(e);var r=new URL(e),o=r.hostname;if(void 0===n){o=""===r.port?o:o+":"+r.port,t=(0,c.normaliseURLDomainOrThrowError)(t);var s=new URL(t);return o===(""===s.port?s.hostname:s.hostname+":"+s.port)}var a,u=(0,c.normaliseSessionScopeOrThrowError)(n);if(n.split(":").length>1){var l=n.split(":")[n.split(":").length-1];"string"!=typeof(a=l)||isNaN(a)||isNaN(parseFloat(a))||(u+=":"+l,o=""===r.port?o:o+":"+r.port)}return n.startsWith(".")?("."+o).endsWith(u):o===u},calculateClockSkewInMillis:function(e){var t=e.accessTokenPayload;(0,i.logDebugMessage)("calculateClockSkewInMillis: called");var n=null==t?void 0:t.iat;if(void 0===n||"number"!=typeof n)return(0,i.logDebugMessage)("calculateClockSkewInMillis: payload iat is undefined or not a number. This may happen due to an unsupported backend sdk. Returning 0"),0;var r=1e3*n-Date.now();return(0,i.logDebugMessage)("calculateClockSkewInMillis: returning "+r),r}}},Rt}var Nt={},Lt={},jt=Y&&Y.__assign||function(){return jt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},jt.apply(this,arguments)};Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.getProxyObject=void 0,Lt.getProxyObject=function(e){for(var t=jt(jt({},e),{_call:function(e,t){throw new Error("This function should only be called through the recipe object")}}),n=function(e){"_call"!==e&&(t[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._call(e,t)})},r=0,o=Object.keys(t);r<o.length;r++){n(o[r])}return t},Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.OverrideableBuilder=void 0;var qt=Lt,Vt=function(){function e(e){this.layers=[e],this.proxies=[]}return e.prototype.override=function(e){for(var t=(0,qt.getProxyObject)(this.layers[0]),n=e(t,this),r=0,o=Object.keys(this.layers[0]);r<o.length;r++){var s=o[r];n[s]===t[s]||"_call"===s?delete n[s]:void 0===n[s]&&(n[s]=null)}return this.layers.push(n),this.proxies.push(t),this},e.prototype.build=function(){var e=this;if(this.result)return this.result;this.result={};for(var t=0,n=this.layers;t<n.length;t++)for(var r=n[t],o=0,s=Object.keys(r);o<s.length;o++){var i=s[o],a=r[i];void 0!==a&&(this.result[i]=null===a?void 0:"function"==typeof a?a.bind(this.result):a)}for(var u=function(t){c.proxies[t]._call=function(n,r){for(var o=t;o>=0;--o){var s=e.layers[o][n];if(null!=s)return s.bind(e.result).apply(void 0,r)}}},c=this,l=0;l<this.proxies.length;++l)u(l);return this.result},e}();Nt.OverrideableBuilder=Vt,Nt.default=Vt;var Bt,Wt={};function Xt(){if(Bt)return Wt;Bt=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.PrimitiveClaim=void 0;var e=ot(),t=function(){function t(t){var n=this;this.validators={hasValue:function(t,r,o){void 0===r&&(r=n.defaultMaxAgeInSeconds);var s=e.default.getReferenceOrThrow().dateProvider;return{id:void 0!==o?o:n.id,refresh:function(e){return n.refresh(e)},shouldRefresh:function(e,t){if(void 0!==r&&r<s.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(s.getThresholdInSeconds()));return void 0===n.getValueFromPayload(e,t)||void 0!==r&&e[n.id].t<s.now()-1e3*r},validate:function(e,o){var i=n.getValueFromPayload(e,o);if(void 0===i)return{isValid:!1,reason:{message:"value does not exist",expectedValue:t,actualValue:i}};var a=(s.now()-n.getLastFetchedTime(e,o))/1e3;return void 0!==r&&a>r?{isValid:!1,reason:{message:"expired",ageInSeconds:a,maxAgeInSeconds:r}}:i!==t?{isValid:!1,reason:{message:"wrong value",expectedValue:t,actualValue:i}}:{isValid:!0}}}}},this.id=t.id,this.refresh=t.refresh,this.defaultMaxAgeInSeconds=t.defaultMaxAgeInSeconds}return t.prototype.getValueFromPayload=function(e,t){return void 0!==e[this.id]?e[this.id].v:void 0},t.prototype.getLastFetchedTime=function(e,t){return void 0!==e[this.id]?e[this.id].t:void 0},t}();return Wt.PrimitiveClaim=t,Wt}var Gt,zt={};function Qt(){if(Gt)return zt;Gt=1;var e=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},t=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(zt,"__esModule",{value:!0}),zt.PrimitiveArrayClaim=void 0;var n=ot(),r=function(){function r(r){var o=this;this.validators={includes:function(r,s,i){void 0===s&&(s=o.defaultMaxAgeInSeconds);var a=n.default.getReferenceOrThrow().dateProvider;return{id:void 0!==i?i:o.id,refresh:function(e){return o.refresh(e)},shouldRefresh:function(e,t){if(void 0!==s&&s<a.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(a.getThresholdInSeconds()));return void 0===o.getValueFromPayload(e,t)||void 0!==s&&e[o.id].t<a.now()-1e3*s},validate:function(n,i){return e(o,void 0,void 0,(function(){var e,o;return t(this,(function(t){return void 0===(e=this.getValueFromPayload(n,i))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:r,actualValue:e}}]:(o=(a.now()-this.getLastFetchedTime(n,i))/1e3,void 0!==s&&o>s?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:o,maxAgeInSeconds:s}}]:e.includes(r)?[2,{isValid:!0}]:[2,{isValid:!1,reason:{message:"wrong value",expectedToInclude:r,actualValue:e}}])}))}))}}},excludes:function(r,s,i){void 0===s&&(s=o.defaultMaxAgeInSeconds);var a=n.default.getReferenceOrThrow().dateProvider;return{id:void 0!==i?i:o.id,refresh:function(e){return o.refresh(e)},shouldRefresh:function(e,t){if(void 0!==s&&s<a.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(a.getThresholdInSeconds()));return void 0===o.getValueFromPayload(e,t)||void 0!==s&&e[o.id].t<a.now()-1e3*s},validate:function(n,i){return e(o,void 0,void 0,(function(){var e,o;return t(this,(function(t){return void 0===(e=this.getValueFromPayload(n,i))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToNotInclude:r,actualValue:e}}]:(o=(a.now()-this.getLastFetchedTime(n,i))/1e3,void 0!==s&&o>s?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:o,maxAgeInSeconds:s}}]:e.includes(r)?[2,{isValid:!1,reason:{message:"wrong value",expectedToNotInclude:r,actualValue:e}}]:[2,{isValid:!0}])}))}))}}},includesAll:function(r,s,i){void 0===s&&(s=o.defaultMaxAgeInSeconds);var a=n.default.getReferenceOrThrow().dateProvider;return{id:void 0!==i?i:o.id,refresh:function(e){return o.refresh(e)},shouldRefresh:function(e,t){if(void 0!==s&&s<a.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(a.getThresholdInSeconds()));return void 0===o.getValueFromPayload(e,t)||void 0!==s&&e[o.id].t<a.now()-1e3*s},validate:function(n,i){return e(o,void 0,void 0,(function(){var e,o,u,c;return t(this,(function(t){return void 0===(e=this.getValueFromPayload(n,i))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:r,actualValue:e}}]:(o=(a.now()-this.getLastFetchedTime(n,i))/1e3,void 0!==s&&o>s?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:o,maxAgeInSeconds:s}}]:(u=new Set(e),[2,(c=r.every((function(e){return u.has(e)})))?{isValid:c}:{isValid:c,reason:{message:"wrong value",expectedToInclude:r,actualValue:e}}]))}))}))}}},includesAny:function(r,s,i){void 0===s&&(s=o.defaultMaxAgeInSeconds);var a=n.default.getReferenceOrThrow().dateProvider;return{id:void 0!==i?i:o.id,refresh:function(e){return o.refresh(e)},shouldRefresh:function(e,t){if(void 0!==s&&s<a.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(a.getThresholdInSeconds()));return void 0===o.getValueFromPayload(e,t)||void 0!==s&&e[o.id].t<a.now()-1e3*s},validate:function(n,i){return e(o,void 0,void 0,(function(){var e,o,u,c;return t(this,(function(t){return void 0===(e=this.getValueFromPayload(n,i))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:r,actualValue:e}}]:(o=(a.now()-this.getLastFetchedTime(n,i))/1e3,void 0!==s&&o>s?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:o,maxAgeInSeconds:s}}]:(u=new Set(e),[2,(c=r.some((function(e){return u.has(e)})))?{isValid:c}:{isValid:c,reason:{message:"wrong value",expectedToIncludeAtLeastOneOf:r,actualValue:e}}]))}))}))}}},excludesAll:function(r,s,i){void 0===s&&(s=o.defaultMaxAgeInSeconds);var a=n.default.getReferenceOrThrow().dateProvider;return{id:void 0!==i?i:o.id,refresh:function(e){return o.refresh(e)},shouldRefresh:function(e,t){if(void 0!==s&&s<a.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(a.getThresholdInSeconds()));return void 0===o.getValueFromPayload(e,t)||void 0!==s&&e[o.id].t<a.now()-1e3*s},validate:function(n,i){return e(o,void 0,void 0,(function(){var e,o,u,c;return t(this,(function(t){return void 0===(e=this.getValueFromPayload(n,i))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToNotInclude:r,actualValue:e}}]:(o=(a.now()-this.getLastFetchedTime(n,i))/1e3,void 0!==s&&o>s?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:o,maxAgeInSeconds:s}}]:(u=new Set(e),[2,(c=r.every((function(e){return!u.has(e)})))?{isValid:c}:{isValid:c,reason:{message:"wrong value",expectedToNotInclude:r,actualValue:e}}]))}))}))}}}},this.id=r.id,this.refresh=r.refresh,this.defaultMaxAgeInSeconds=r.defaultMaxAgeInSeconds}return r.prototype.getValueFromPayload=function(e,t){return void 0!==e[this.id]?e[this.id].v:void 0},r.prototype.getLastFetchedTime=function(e,t){return void 0!==e[this.id]?e[this.id].t:void 0},r}();return zt.PrimitiveArrayClaim=r,zt}var Jt,Kt,Yt,$t={};function Zt(){return Kt||(Kt=1,function(e){var t=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},n=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.BooleanClaim=e.PrimitiveArrayClaim=e.PrimitiveClaim=e.getInvalidClaimsFromResponse=e.getClaimValue=e.validateClaims=e.signOut=e.addAxiosInterceptors=e.doesSessionExist=e.attemptRefreshingSession=e.getAccessToken=e.getAccessTokenPayloadSecurely=e.getUserId=e.init=void 0;var r=st(),o=Ft(),s=Nt,i=Ae(),a=qe(),u=le(),c=Je(),l=ut(),d=$e(),f=ot(),h=function(){function e(){}var h;return e.init=function(t){a.default.init(t.cookieHandler),u.default.init(t.windowHandler),f.default.init(t.dateProvider),c.default.init(t.lockFactory,u.default.getReferenceOrThrow().windowHandler.localStorage);var n=(0,i.validateAndNormaliseInputOrThrowError)(t);void 0!==t.enableDebugLogs&&t.enableDebugLogs&&(0,d.enableLogging)();var l=new s.default((0,o.default)({onHandleEvent:n.onHandleEvent,preAPIHook:n.preAPIHook,postAPIHook:n.postAPIHook,sessionExpiredStatusCode:n.sessionExpiredStatusCode})).override(n.override.functions).build();r.default.init(n,l),e.axiosInterceptorQueue.forEach((function(e){e()})),e.axiosInterceptorQueue=[]},e.getUserId=function(e){return r.default.recipeImpl.getUserId({userContext:(0,i.getNormalisedUserContext)(void 0===e?void 0:e.userContext)})},e.getAccessTokenPayloadSecurely=function(e){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,r.default.recipeImpl.getAccessTokenPayloadSecurely({userContext:(0,i.getNormalisedUserContext)(void 0===e?void 0:e.userContext)})]}))}))},h=e,e.axiosInterceptorQueue=[],e.attemptRefreshingSession=function(){return t(void 0,void 0,void 0,(function(){return n(h,(function(e){return[2,r.default.attemptRefreshingSession()]}))}))},e.doesSessionExist=function(e){return r.default.recipeImpl.doesSessionExist({userContext:(0,i.getNormalisedUserContext)(void 0===e?void 0:e.userContext)})},e.addAxiosInterceptors=function(t,n){r.default.initCalled?r.default.recipeImpl.addAxiosInterceptors({axiosInstance:t,userContext:(0,i.getNormalisedUserContext)(n)}):e.axiosInterceptorQueue.push((function(){r.default.recipeImpl.addAxiosInterceptors({axiosInstance:t,userContext:(0,i.getNormalisedUserContext)(n)})}))},e.signOut=function(e){return r.default.recipeImpl.signOut({userContext:(0,i.getNormalisedUserContext)(void 0===e?void 0:e.userContext)})},e.getInvalidClaimsFromResponse=function(e){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,r.default.recipeImpl.getInvalidClaimsFromResponse({response:e.response,userContext:(0,i.getNormalisedUserContext)(e.userContext)})]}))}))},e.getClaimValue=function(r){return t(this,void 0,void 0,(function(){var t,o;return n(this,(function(n){switch(n.label){case 0:return t=(0,i.getNormalisedUserContext)(void 0===r?void 0:r.userContext),[4,e.getAccessTokenPayloadSecurely({userContext:t})];case 1:return o=n.sent(),[2,r.claim.getValueFromPayload(o,t)]}}))}))},e.validateClaims=function(e,t){var n=(0,i.getNormalisedUserContext)(t),o=l.SessionClaimValidatorStore.getClaimValidatorsAddedByOtherRecipes(),s=r.default.recipeImpl.getGlobalClaimValidators({claimValidatorsAddedByOtherRecipes:o,userContext:n}),a=void 0!==e?e(s,n):s;return 0===a.length?[]:r.default.recipeImpl.validateClaims({claimValidators:a,userContext:(0,i.getNormalisedUserContext)(t)})},e.getAccessToken=function(e){return t(void 0,void 0,void 0,(function(){return n(h,(function(t){switch(t.label){case 0:return[4,r.default.recipeImpl.doesSessionExist({userContext:(0,i.getNormalisedUserContext)(void 0===e?void 0:e.userContext)})];case 1:return t.sent()?[2,(0,r.getTokenForHeaderAuth)("access")]:[2,void 0]}}))}))},e}();e.default=h,e.init=h.init,e.getUserId=h.getUserId,e.getAccessTokenPayloadSecurely=h.getAccessTokenPayloadSecurely,e.getAccessToken=h.getAccessToken,e.attemptRefreshingSession=h.attemptRefreshingSession,e.doesSessionExist=h.doesSessionExist,e.addAxiosInterceptors=h.addAxiosInterceptors,e.signOut=h.signOut,e.validateClaims=h.validateClaims,e.getClaimValue=h.getClaimValue,e.getInvalidClaimsFromResponse=h.getInvalidClaimsFromResponse;var p=Xt();Object.defineProperty(e,"PrimitiveClaim",{enumerable:!0,get:function(){return p.PrimitiveClaim}});var g=Qt();Object.defineProperty(e,"PrimitiveArrayClaim",{enumerable:!0,get:function(){return g.PrimitiveArrayClaim}});var v=function(){if(Jt)return $t;Jt=1;var e,t=Y&&Y.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),n=Y&&Y.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty($t,"__esModule",{value:!0}),$t.BooleanClaim=void 0;var r=function(e){function r(t){var r=e.call(this,t)||this;return r.validators=n(n({},r.validators),{isTrue:function(e){return r.validators.hasValue(!0,e)},isFalse:function(e){return r.validators.hasValue(!1,e)}}),r}return t(r,e),r}(Xt().PrimitiveClaim);return $t.BooleanClaim=r,$t}();Object.defineProperty(e,"BooleanClaim",{enumerable:!0,get:function(){return v.BooleanClaim}})}(Tt)),Tt}function en(){return Yt||(Yt=1,function(e){e.__esModule=!0,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(Zt())}(kt)),kt}var tn={};Object.defineProperty(tn,"__esModule",{value:!0}),tn.EMAILVERIFICATION_CLAIM_ID=void 0,tn.EMAILVERIFICATION_CLAIM_ID="st-ev";var nn,rn=Y&&Y.__extends||(nn=function(e,t){return nn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},nn(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}nn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),on=Y&&Y.__assign||function(){return on=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},on.apply(this,arguments)},sn=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},an=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},un=Y&&Y.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,s=t.length;o<s;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(mt,"__esModule",{value:!0}),mt.Recipe=void 0;var cn=yt,ln=en(),dn=oe,fn=[tn.EMAILVERIFICATION_CLAIM_ID],hn=function(e){function t(t){var n=e.call(this,t)||this;return n.getUserId=function(e){return ln.default.getUserId({userContext:e.userContext})},n.getAccessToken=function(e){return sn(n,void 0,void 0,(function(){return an(this,(function(t){return[2,ln.default.getAccessToken({userContext:e.userContext})]}))}))},n.getAccessTokenPayloadSecurely=function(e){return sn(n,void 0,void 0,(function(){return an(this,(function(t){return[2,ln.default.getAccessTokenPayloadSecurely({userContext:e.userContext})]}))}))},n.doesSessionExist=function(e){return ln.default.doesSessionExist({userContext:e.userContext})},n.signOut=function(e){return ln.default.signOut({userContext:e.userContext})},n.attemptRefreshingSession=function(){return sn(n,void 0,void 0,(function(){return an(this,(function(e){return[2,ln.default.attemptRefreshingSession()]}))}))},n.validateClaims=function(e){return ln.default.validateClaims(e.overrideGlobalClaimValidators,e.userContext)},ln.default.init(on(on({},t),{override:{functions:function(e,n){var r;return n.override((function(e){return on(on({},e),{getGlobalClaimValidators:function(t){var n=e.getGlobalClaimValidators(t);return un(un([],n.filter((function(e){return fn.includes(e.id)})),!0),n.filter((function(e){return!fn.includes(e.id)})),!0)}})})),(null===(r=t.override)||void 0===r?void 0:r.functions)&&n.override(t.override.functions),e}},preAPIHook:function(e){return sn(n,void 0,void 0,(function(){var n,r;return an(this,(function(o){return(n=new Headers(e.requestInit.headers)).set("rid",t.recipeId),r=on(on({},e),{requestInit:on(on({},e.requestInit),{headers:n})}),void 0===t.preAPIHook?[2,r]:[2,t.preAPIHook(e)]}))}))},apiDomain:t.appInfo.apiDomain.getAsStringDangerous(),apiBasePath:t.appInfo.apiBasePath.getAsStringDangerous()})),n}return rn(t,e),t.init=function(e){return function(n,r,o){return t.instance=new t(on(on({},e),{appInfo:n,recipeId:t.RECIPE_ID,enableDebugLogs:o})),t.instance}},t.prototype.getClaimValue=function(e){return ln.default.getClaimValue(e)},t.prototype.getInvalidClaimsFromResponse=function(e){return ln.default.getInvalidClaimsFromResponse(e)},t.addAxiosInterceptors=function(e,t){return ln.default.addAxiosInterceptors(e,t)},t.getInstanceOrThrow=function(){if(void 0===t.instance){var e="No instance of Session found. Ensure that the 'Session.init' method is called within the 'SuperTokens.init' recipeList.";throw e=(0,dn.checkForSSRErrorAndAppendIfNeeded)(e),Error(e)}return t.instance},t.reset=function(){(0,dn.isTest)()&&(t.instance=void 0)},t.RECIPE_ID="session",t}(cn.default);mt.Recipe=hn,mt.default=hn,function(e){var t=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},n=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.getInvalidClaimsFromResponse=e.getClaimValue=e.validateClaims=e.signOut=e.addAxiosInterceptors=e.doesSessionExist=e.attemptRefreshingSession=e.getAccessToken=e.getAccessTokenPayloadSecurely=e.getUserId=e.init=e.BooleanClaim=e.PrimitiveArrayClaim=e.PrimitiveClaim=void 0;var r=oe,o=mt,s=function(){function e(){}return e.init=function(e){return o.default.init(e)},e.getUserId=function(e){return o.default.getInstanceOrThrow().getUserId({userContext:(0,r.getNormalisedUserContext)(null==e?void 0:e.userContext)})},e.getAccessToken=function(e){return o.default.getInstanceOrThrow().getAccessToken({userContext:(0,r.getNormalisedUserContext)(null==e?void 0:e.userContext)})},e.getAccessTokenPayloadSecurely=function(e){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,o.default.getInstanceOrThrow().getAccessTokenPayloadSecurely({userContext:(0,r.getNormalisedUserContext)(null==e?void 0:e.userContext)})]}))}))},e.attemptRefreshingSession=function(){return t(this,void 0,void 0,(function(){return n(this,(function(e){return[2,o.default.getInstanceOrThrow().attemptRefreshingSession()]}))}))},e.doesSessionExist=function(e){return o.default.getInstanceOrThrow().doesSessionExist({userContext:(0,r.getNormalisedUserContext)(null==e?void 0:e.userContext)})},e.addAxiosInterceptors=function(e,t){return o.default.addAxiosInterceptors(e,(0,r.getNormalisedUserContext)(t))},e.signOut=function(e){return o.default.getInstanceOrThrow().signOut({userContext:(0,r.getNormalisedUserContext)(null==e?void 0:e.userContext)})},e.getClaimValue=function(e){return o.default.getInstanceOrThrow().getClaimValue({claim:e.claim,userContext:(0,r.getNormalisedUserContext)(null==e?void 0:e.userContext)})},e.validateClaims=function(e){return o.default.getInstanceOrThrow().validateClaims({overrideGlobalClaimValidators:null==e?void 0:e.overrideGlobalClaimValidators,userContext:(0,r.getNormalisedUserContext)(null==e?void 0:e.userContext)})},e.getInvalidClaimsFromResponse=function(e){return o.default.getInstanceOrThrow().getInvalidClaimsFromResponse({response:e.response,userContext:(0,r.getNormalisedUserContext)(null==e?void 0:e.userContext)})},e}();e.default=s;var i=s.init;e.init=i;var a=s.getUserId;e.getUserId=a;var u=s.getAccessTokenPayloadSecurely;e.getAccessTokenPayloadSecurely=u;var c=s.getAccessToken;e.getAccessToken=c;var l=s.attemptRefreshingSession;e.attemptRefreshingSession=l;var d=s.doesSessionExist;e.doesSessionExist=d;var f=s.addAxiosInterceptors;e.addAxiosInterceptors=f;var h=s.signOut;e.signOut=h;var p=s.validateClaims;e.validateClaims=p;var g=s.getClaimValue;e.getClaimValue=g;var v=s.getInvalidClaimsFromResponse;e.getInvalidClaimsFromResponse=v;var b=en();Object.defineProperty(e,"PrimitiveClaim",{enumerable:!0,get:function(){return b.PrimitiveClaim}}),Object.defineProperty(e,"PrimitiveArrayClaim",{enumerable:!0,get:function(){return b.PrimitiveArrayClaim}}),Object.defineProperty(e,"BooleanClaim",{enumerable:!0,get:function(){return b.BooleanClaim}})}(re),function(e){e.__esModule=!0,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(re)}(ne);var pn=$(ne),gn={},vn={},bn={},mn={},yn={};!function(e){e.__esModule=!0,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(qe())}(yn),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CookieHandlerReference=void 0;var t=yn;Object.defineProperty(e,"CookieHandlerReference",{enumerable:!0,get:function(){return t.CookieHandlerReference}})}(mn);var wn={};Object.defineProperty(wn,"__esModule",{value:!0}),wn.PostSuperTokensInitCallbacks=void 0;var In=function(){function e(){}return e.addPostInitCallback=function(t){e.postInitCallbacks.push(t)},e.runPostInitCallbacks=function(){for(var t=0,n=e.postInitCallbacks;t<n.length;t++){(0,n[t])()}},e.postInitCallbacks=[],e}();wn.PostSuperTokensInitCallbacks=In;var Sn={},kn={},Tn={},Rn={},_n=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},Pn=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.normaliseRecipeModuleConfig=void 0,Rn.normaliseRecipeModuleConfig=function(e){var t=this,n=e.preAPIHook;void 0===n&&(n=function(e){return _n(t,void 0,void 0,(function(){return Pn(this,(function(t){return[2,e]}))}))});var r=e.postAPIHook;return void 0===r&&(r=function(){return _n(t,void 0,void 0,(function(){return Pn(this,(function(e){return[2]}))}))}),{recipeId:e.recipeId,appInfo:e.appInfo,clientType:e.clientType,preAPIHook:n,postAPIHook:r}},Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.normaliseAuthRecipe=void 0;var An=Rn;Tn.normaliseAuthRecipe=function(e){return(0,An.normaliseRecipeModuleConfig)(e)};var xn=Y&&Y.__assign||function(){return xn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},xn.apply(this,arguments)};Object.defineProperty(kn,"__esModule",{value:!0}),kn.normaliseUserInput=void 0;var On=Tn;kn.normaliseUserInput=function(e){var t=xn({functions:function(e){return e}},e.override);return xn(xn({},(0,On.normaliseAuthRecipe)(e)),{override:t})};var En={},Cn={},Dn={};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.supported_fdi=Dn.package_version=void 0,Dn.package_version="0.10.1",Dn.supported_fdi=["1.17","1.18","1.19"];var Mn={},Un={};!function(e){function t(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}e.__esModule=!0;let n=Ct();void 0!==n.default?t(n):t({default:n,...n})}(Un),Object.defineProperty(Mn,"__esModule",{value:!0});var Hn=Un;Mn.default=Hn.STGeneralError;var Fn=Y&&Y.__assign||function(){return Fn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Fn.apply(this,arguments)},Nn=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},Ln=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(Cn,"__esModule",{value:!0});var jn=ge,qn=Dn,Vn=Mn,Bn=function(){function e(e,t){var n=this;this.recipeId=e,this.appInfo=t,this.get=function(e,t,r,o,s,i){return Nn(n,void 0,void 0,(function(){var n;return Ln(this,(function(a){switch(a.label){case 0:return[4,this.fetch(this.getFullUrl(e,t,o),Fn({method:"GET"},r),s,i)];case 1:return n=a.sent(),[4,this.getResponseJsonOrThrowGeneralError(n)];case 2:return[2,{jsonBody:a.sent(),fetchResponse:n}]}}))}))},this.post=function(e,t,r,o,s){return Nn(n,void 0,void 0,(function(){var n;return Ln(this,(function(i){switch(i.label){case 0:if(void 0===r.body)throw new Error("Post request must have a body");return[4,this.fetch(this.getFullUrl(e,t),Fn({method:"POST"},r),o,s)];case 1:return n=i.sent(),[4,this.getResponseJsonOrThrowGeneralError(n)];case 2:return[2,{jsonBody:i.sent(),fetchResponse:n}]}}))}))},this.delete=function(e,t,r,o,s){return Nn(n,void 0,void 0,(function(){var n;return Ln(this,(function(i){switch(i.label){case 0:return[4,this.fetch(this.getFullUrl(e,t),Fn({method:"DELETE"},r),o,s)];case 1:return n=i.sent(),[4,this.getResponseJsonOrThrowGeneralError(n)];case 2:return[2,{jsonBody:i.sent(),fetchResponse:n}]}}))}))},this.put=function(e,t,r,o,s){return Nn(n,void 0,void 0,(function(){var n;return Ln(this,(function(i){switch(i.label){case 0:return[4,this.fetch(this.getFullUrl(e,t),Fn({method:"PUT"},r),o,s)];case 1:return n=i.sent(),[4,this.getResponseJsonOrThrowGeneralError(n)];case 2:return[2,{jsonBody:i.sent(),fetchResponse:n}]}}))}))},this.fetch=function(e,t,r,o){return Nn(n,void 0,void 0,(function(){var n,s,i,a,u,c;return Ln(this,(function(l){switch(l.label){case 0:return n=void 0===t?{}:t.headers,[4,this.callPreAPIHook({preAPIHook:r,url:e,requestInit:Fn(Fn({},t),{headers:Fn(Fn({},n),{"fdi-version":qn.supported_fdi.join(","),"Content-Type":"application/json",rid:this.recipeId})})})];case 1:return s=l.sent(),i=s.requestInit,a=s.url,[4,fetch(a,i)];case 2:if((u=l.sent()).status>=300)throw u;return void 0===o?[3,4]:(c=u.clone(),[4,o({requestInit:i,url:e,fetchResponse:c})]);case 3:l.sent(),l.label=4;case 4:return[2,u]}}))}))},this.callPreAPIHook=function(e){return Nn(n,void 0,void 0,(function(){return Ln(this,(function(t){switch(t.label){case 0:return void 0===e.preAPIHook?[2,{url:e.url,requestInit:e.requestInit}]:[4,e.preAPIHook({url:e.url,requestInit:e.requestInit})];case 1:return[2,t.sent()]}}))}))},this.getFullUrl=function(e,t,r){var o=n.appInfo.apiBasePath.getAsStringDangerous();void 0!==e&&"public"!==e&&(o="".concat(o,"/").concat(e));var s=new jn.default(t),i="".concat(n.appInfo.apiDomain.getAsStringDangerous()).concat(o).concat(s.getAsStringDangerous());return void 0===r?i:i+"?"+new URLSearchParams(r)},this.getResponseJsonOrThrowGeneralError=function(e){return Nn(n,void 0,void 0,(function(){var t,n;return Ln(this,(function(r){switch(r.label){case 0:return[4,e.clone().json()];case 1:if("GENERAL_ERROR"===(t=r.sent()).status)throw n=void 0===t.message?"No Error Message Provided":t.message,new Vn.default(n);return[2,t]}}))}))}}var t;return t=e,e.preparePreAPIHook=function(e){var n=e.recipePreAPIHook,r=e.action,o=e.options,s=e.userContext;return function(e){return Nn(void 0,void 0,void 0,(function(){var i;return Ln(t,(function(t){switch(t.label){case 0:return[4,n(Fn(Fn({},e),{action:r,userContext:s}))];case 1:return i=t.sent(),void 0===o||void 0===o.preAPIHook?[2,i]:[2,o.preAPIHook({url:i.url,requestInit:i.requestInit,userContext:s})]}}))}))}},e.preparePostAPIHook=function(e){var n=e.recipePostAPIHook,r=e.action,o=e.userContext;return function(e){return Nn(void 0,void 0,void 0,(function(){return Ln(t,(function(t){switch(t.label){case 0:return[4,n(Fn(Fn({},e),{userContext:o,action:r}))];case 1:return t.sent(),[2]}}))}))}},e}();Cn.default=Bn;var Wn=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},Xn=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(En,"__esModule",{value:!0}),En.getRecipeImplementation=void 0;var Gn=Cn;function zn(e){var t=new Gn.default(e.recipeId,e.appInfo);return{getTenantId:function(){},getLoginMethods:function(n){var r=n.tenantId,o=n.options,s=n.userContext;return Wn(this,void 0,void 0,(function(){var n,i,a,u,c;return Xn(this,(function(l){switch(l.label){case 0:return n={},void 0!==e.clientType&&(n.clientType=e.clientType),[4,t.get(r,"/loginmethods",{},n,Gn.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"GET_LOGIN_METHODS",options:o,userContext:s}),Gn.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"GET_LOGIN_METHODS",userContext:s}))];case 1:return i=l.sent(),a=i.jsonBody,u=i.fetchResponse,void 0===a.firstFactors?(c=[],a.emailPassword.enabled&&c.push("emailpassword"),a.thirdParty.enabled&&c.push("thirdparty"),a.passwordless.enabled&&(c.push("otp-email"),c.push("otp-phone"),c.push("link-email"),c.push("link-phone"))):c=a.firstFactors,[2,{status:"OK",thirdParty:{providers:a.thirdParty.providers},firstFactors:c,fetchResponse:u}]}}))}))}}}En.default=zn,En.getRecipeImplementation=zn;var Qn={},Jn=Y&&Y.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kn=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},Yn=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(Qn,"__esModule",{value:!0});var $n=mt,Zn=function(e){function t(t){var n=e.call(this,t)||this;return n.signOut=function(e){return Kn(n,void 0,void 0,(function(){return Yn(this,(function(t){switch(t.label){case 0:return[4,$n.default.getInstanceOrThrow().signOut({userContext:e.userContext})];case 1:return[2,t.sent()]}}))}))},n}return Jn(t,e),t}(yt.default);Qn.default=Zn;var er=Y&&Y.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),tr=Y&&Y.__assign||function(){return tr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},tr.apply(this,arguments)};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.Recipe=void 0;var nr=kn,rr=Nt,or=En,sr=oe,ir=function(e){function t(t){var n=e.call(this,(0,nr.normaliseUserInput)(t))||this,r=new rr.default((0,or.default)({recipeId:n.config.recipeId,appInfo:n.config.appInfo,clientType:n.config.clientType,preAPIHook:n.config.preAPIHook,postAPIHook:n.config.postAPIHook}));return n.recipeImplementation=r.override(n.config.override.functions).build(),n}return er(t,e),t.init=function(e){return function(n,r){return t.instance=new t(tr(tr({},e),{recipeId:t.RECIPE_ID,appInfo:n,clientType:r})),t.instance}},t.getInstanceOrThrow=function(){if(void 0===t.instance){var e="No instance of Multitenancy found. Ensure that 'SuperTokens.init' method has been called.";throw e=(0,sr.checkForSSRErrorAndAppendIfNeeded)(e),Error(e)}return t.instance},t.reset=function(){(0,sr.isTest)()&&(t.instance=void 0)},t.RECIPE_ID="multitenancy",t}(Qn.default);Sn.Recipe=ir,Sn.default=ir;var ar={},ur={};!function(e){e.__esModule=!0,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(ot())}(ur),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DateProviderReference=void 0;var t=ur;Object.defineProperty(e,"DateProviderReference",{enumerable:!0,get:function(){return t.DateProviderReference}})}(ar),Object.defineProperty(bn,"__esModule",{value:!0});var cr=oe,lr=mn,dr=se,fr=wn,hr=Sn,pr=ar,gr=function(){function e(e){var t=this;if(this.recipeList=[],this.appInfo=(0,cr.normaliseInputAppInfoOrThrowError)(e.appInfo),void 0===e.recipeList||0===e.recipeList.length)throw new Error("Please provide at least one recipe to the supertokens.init function call. See https://supertokens.io/docs/emailpassword/quick-setup/frontend");var n=!1;void 0!==e.enableDebugLogs&&(n=e.enableDebugLogs);var r=!1;this.recipeList=e.recipeList.map((function(o){var s=o(t.appInfo,e.clientType,n);return s.config.recipeId===hr.Recipe.RECIPE_ID&&(r=!0),s})),r||this.recipeList.push(hr.Recipe.init()(this.appInfo,e.clientType,n))}return e.init=function(t){lr.CookieHandlerReference.init(t.cookieHandler),dr.WindowHandlerReference.init(t.windowHandler),pr.DateProviderReference.init(t.dateProvider),void 0===e.instance?(e.instance=new e(t),fr.PostSuperTokensInitCallbacks.runPostInitCallbacks()):console.warn("SuperTokens was already initialized")},e.getInstanceOrThrow=function(){if(void 0===e.instance){var t="SuperTokens must be initialized before calling this method.";throw t=(0,cr.checkForSSRErrorAndAppendIfNeeded)(t),new Error(t)}return e.instance},e.reset=function(){(0,cr.isTest)()?e.instance=void 0:console.warn("Calling reset() is only supported during testing")},e}();bn.default=gr,Object.defineProperty(vn,"__esModule",{value:!0}),vn.init=void 0;var vr=bn,br=function(){function e(){}return e.init=function(e){vr.default.init(e)},e}();vn.default=br,vn.init=br.init,function(e){e.__esModule=!0,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(vn)}(gn);var mr=$(gn),yr={},wr={},Ir={},Sr={},kr={},Tr=Y&&Y.__assign||function(){return Tr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Tr.apply(this,arguments)};Object.defineProperty(kr,"__esModule",{value:!0}),kr.normaliseUserInput=void 0;var Rr=Tn;kr.normaliseUserInput=function(e){var t=Tr({functions:function(e){return e}},e.override);return Tr(Tr({},(0,Rr.normaliseAuthRecipe)(e)),{override:t})};var _r={},Pr=Y&&Y.__assign||function(){return Pr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Pr.apply(this,arguments)},Ar=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},xr=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(_r,"__esModule",{value:!0}),_r.getRecipeImplementation=void 0;var Or=Cn,Er=Sn,Cr=oe;function Dr(e){var t=new Or.default(e.recipeId,e.appInfo);return{submitNewPassword:function(n){var r=n.formFields,o=n.options,s=n.userContext;return Ar(this,void 0,void 0,(function(){var n,i,a,u,c;return xr(this,(function(l){switch(l.label){case 0:return n=this.getTenantIdFromURL({userContext:s}),i=this.getResetPasswordTokenFromURL({userContext:s}),[4,t.post(n,"/user/password/reset",{body:JSON.stringify({formFields:r,token:i,method:"token"})},Or.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"SUBMIT_NEW_PASSWORD",options:o,userContext:s}),Or.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"SUBMIT_NEW_PASSWORD",userContext:s}))];case 1:return a=l.sent(),u=a.jsonBody,c=a.fetchResponse,"FIELD_ERROR"===u.status?[2,{status:"FIELD_ERROR",formFields:u.formFields,fetchResponse:c}]:"RESET_PASSWORD_INVALID_TOKEN_ERROR"===u.status?[2,{status:u.status,fetchResponse:c}]:[2,Pr(Pr({},u),{fetchResponse:c})]}}))}))},sendPasswordResetEmail:function(n){var r=n.formFields,o=n.options,s=n.userContext;return Ar(this,void 0,void 0,(function(){var n,i,a,u,c;return xr(this,(function(l){switch(l.label){case 0:return c=(u=t).post,[4,Er.default.getInstanceOrThrow().recipeImplementation.getTenantId({userContext:s})];case 1:return[4,c.apply(u,[l.sent(),"/user/password/reset/token",{body:JSON.stringify({formFields:r})},Or.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"SEND_RESET_PASSWORD_EMAIL",options:o,userContext:s}),Or.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"SEND_RESET_PASSWORD_EMAIL",userContext:s})])];case 2:return n=l.sent(),i=n.jsonBody,a=n.fetchResponse,"FIELD_ERROR"===i.status?[2,{status:"FIELD_ERROR",formFields:i.formFields,fetchResponse:a}]:"PASSWORD_RESET_NOT_ALLOWED"===i.status?[2,{status:i.status,reason:i.reason,fetchResponse:a}]:[2,{status:i.status,fetchResponse:a}]}}))}))},signUp:function(n){var r=n.formFields,o=n.options,s=n.userContext;return Ar(this,void 0,void 0,(function(){var n,i,a,u,c;return xr(this,(function(l){switch(l.label){case 0:return c=(u=t).post,[4,Er.default.getInstanceOrThrow().recipeImplementation.getTenantId({userContext:s})];case 1:return[4,c.apply(u,[l.sent(),"/signup",{body:JSON.stringify({formFields:r})},Or.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"EMAIL_PASSWORD_SIGN_UP",options:o,userContext:s}),Or.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"EMAIL_PASSWORD_SIGN_UP",userContext:s})])];case 2:return n=l.sent(),i=n.jsonBody,a=n.fetchResponse,"FIELD_ERROR"===i.status?[2,{status:"FIELD_ERROR",formFields:i.formFields,fetchResponse:a}]:"SIGN_UP_NOT_ALLOWED"===i.status?[2,{status:"SIGN_UP_NOT_ALLOWED",reason:i.reason,fetchResponse:a}]:[2,{status:i.status,user:(0,Cr.normaliseUser)("emailpassword",i.user),fetchResponse:a}]}}))}))},signIn:function(n){var r=n.formFields,o=n.options,s=n.userContext;return Ar(this,void 0,void 0,(function(){var n,i,a,u,c;return xr(this,(function(l){switch(l.label){case 0:return c=(u=t).post,[4,Er.default.getInstanceOrThrow().recipeImplementation.getTenantId({userContext:s})];case 1:return[4,c.apply(u,[l.sent(),"/signin",{body:JSON.stringify({formFields:r})},Or.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"EMAIL_PASSWORD_SIGN_IN",options:o,userContext:s}),Or.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"EMAIL_PASSWORD_SIGN_IN",userContext:s})])];case 2:return n=l.sent(),i=n.jsonBody,a=n.fetchResponse,"FIELD_ERROR"===i.status?[2,{status:"FIELD_ERROR",formFields:i.formFields,fetchResponse:a}]:"WRONG_CREDENTIALS_ERROR"===i.status?[2,{status:"WRONG_CREDENTIALS_ERROR",fetchResponse:a}]:"SIGN_IN_NOT_ALLOWED"===i.status?[2,{status:"SIGN_IN_NOT_ALLOWED",reason:i.reason,fetchResponse:a}]:[2,{status:"OK",user:(0,Cr.normaliseUser)("emailpassword",i.user),fetchResponse:a}]}}))}))},doesEmailExist:function(n){var r=n.email,o=n.options,s=n.userContext;return Ar(this,void 0,void 0,(function(){var n,i,a,u,c;return xr(this,(function(l){switch(l.label){case 0:return c=(u=t).get,[4,Er.default.getInstanceOrThrow().recipeImplementation.getTenantId({userContext:s})];case 1:return[4,c.apply(u,[l.sent(),"/signup/email/exists",{},{email:r},Or.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"EMAIL_EXISTS",options:o,userContext:s}),Or.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"EMAIL_EXISTS",userContext:s})])];case 2:return n=l.sent(),i=n.jsonBody,a=n.fetchResponse,[2,{status:i.status,doesExist:i.exists,fetchResponse:a}]}}))}))},getResetPasswordTokenFromURL:function(){var e=(0,Cr.getQueryParams)("token");return void 0===e?"":e},getTenantIdFromURL:function(){return(0,Cr.getQueryParams)("tenantId")}}}_r.default=Dr,_r.getRecipeImplementation=Dr;var Mr=Y&&Y.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ur=Y&&Y.__assign||function(){return Ur=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ur.apply(this,arguments)};Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.Recipe=void 0;var Hr=kr,Fr=_r,Nr=Nt,Lr=oe,jr=function(e){function t(t){var n=e.call(this,(0,Hr.normaliseUserInput)(t))||this,r=new Nr.default((0,Fr.default)({recipeId:n.config.recipeId,appInfo:n.config.appInfo,clientType:n.config.clientType,preAPIHook:n.config.preAPIHook,postAPIHook:n.config.postAPIHook}));return n.recipeImplementation=r.override(n.config.override.functions).build(),n}return Mr(t,e),t.init=function(e){return function(n,r){return t.instance=new t(Ur(Ur({},e),{recipeId:t.RECIPE_ID,clientType:r,appInfo:n})),t.instance}},t.getInstanceOrThrow=function(){if(void 0===t.instance){var e="No instance of EmailPassword found. Ensure that the 'EmailPassword.init' method is called within the 'SuperTokens.init' recipeList.";throw e=(0,Lr.checkForSSRErrorAndAppendIfNeeded)(e),Error(e)}return t.instance},t.reset=function(){(0,Lr.isTest)()&&(t.instance=void 0)},t.RECIPE_ID="emailpassword",t}(Qn.default);Sr.Recipe=jr,Sr.default=jr;var qr={},Vr={},Br=Y&&Y.__assign||function(){return Br=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Br.apply(this,arguments)};Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.normaliseUserInput=void 0;var Wr=Tn;Vr.normaliseUserInput=function(e){var t=Br({functions:function(e){return e}},e.override);return Br(Br({},(0,Wr.normaliseAuthRecipe)(e)),{override:t})};var Xr={},Gr=Y&&Y.__assign||function(){return Gr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Gr.apply(this,arguments)},zr=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},Qr=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.getRecipeImplementation=void 0;var Jr=Cn,Kr=oe,Yr=Mn,$r=se;function Zr(e){var t=new Jr.default(e.recipeId,e.appInfo);return{getStateAndOtherInfoFromStorage:function(){var e=$r.WindowHandlerReference.getReferenceOrThrow().windowHandler.sessionStorage.getItemSync("supertokens-oauth-state-2");if(null!==e)try{return JSON.parse(e)}catch(e){return}},setStateAndOtherInfoToStorage:function(e){return zr(this,void 0,void 0,(function(){var t;return Qr(this,(function(n){switch(n.label){case 0:return t=JSON.stringify(Gr({},e.state)),[4,$r.WindowHandlerReference.getReferenceOrThrow().windowHandler.sessionStorage.setItem("supertokens-oauth-state-2",t)];case 1:return n.sent(),[2]}}))}))},getAuthorisationURLWithQueryParamsAndSetState:function(e){return zr(this,void 0,void 0,(function(){var t,n,r,o;return Qr(this,(function(s){switch(s.label){case 0:return[4,this.getAuthorisationURLFromBackend({thirdPartyId:e.thirdPartyId,tenantId:e.tenantId,redirectURIOnProviderDashboard:e.redirectURIOnProviderDashboard||e.frontendRedirectURI,userContext:e.userContext,options:e.options})];case 1:return t=s.sent(),n=void 0!==e.redirectURIOnProviderDashboard&&e.frontendRedirectURI!==e.redirectURIOnProviderDashboard?e.frontendRedirectURI:void 0,r=this.generateStateToSendToOAuthProvider({frontendRedirectURI:n,userContext:e.userContext}),o=Date.now()+6e5,[4,this.setStateAndOtherInfoToStorage({state:{stateForAuthProvider:r,thirdPartyId:e.thirdPartyId,tenantId:e.tenantId,expiresAt:o,redirectURIOnProviderDashboard:e.redirectURIOnProviderDashboard||e.frontendRedirectURI,pkceCodeVerifier:t.pkceCodeVerifier},userContext:e.userContext})];case 2:return s.sent(),[2,(0,Kr.appendQueryParamsToURL)(t.urlWithQueryParams,{state:r})]}}))}))},getAuthorisationURLFromBackend:function(n){return zr(this,void 0,void 0,(function(){var r,o,s,i;return Qr(this,(function(a){switch(a.label){case 0:return r={thirdPartyId:n.thirdPartyId,redirectURIOnProviderDashboard:n.redirectURIOnProviderDashboard},void 0!==e.clientType&&(r.clientType=e.clientType),[4,t.get(n.tenantId,"/authorisationurl",{},r,Jr.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"GET_AUTHORISATION_URL",options:n.options,userContext:n.userContext}),Jr.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"GET_AUTHORISATION_URL",userContext:n.userContext}))];case 1:return o=a.sent(),s=o.jsonBody,i=o.fetchResponse,[2,{status:"OK",urlWithQueryParams:s.urlWithQueryParams,pkceCodeVerifier:s.pkceCodeVerifier,fetchResponse:i}]}}))}))},signInAndUp:function(n){return zr(this,void 0,void 0,(function(){var r,o,s,i,a,u,c,l,d;return Qr(this,(function(f){switch(f.label){case 0:return r=this.getStateAndOtherInfoFromStorage({userContext:n.userContext}),o=this.getAuthStateFromURL({userContext:n.userContext}),[4,this.verifyAndGetStateOrThrowError({stateFromAuthProvider:o,stateObjectFromStorage:r,userContext:n.userContext})];case 1:if(s=f.sent(),void 0!==(i=this.getAuthErrorFromURL({userContext:n.userContext})))throw new Error("Auth provider responded with error: ".concat(i));return a=(0,Kr.getAllQueryParams)(),u=Object.fromEntries(a),[4,t.post(s.tenantId,"/signinup",{body:JSON.stringify({thirdPartyId:s.thirdPartyId,clientType:e.clientType,redirectURIInfo:{redirectURIOnProviderDashboard:s.redirectURIOnProviderDashboard,redirectURIQueryParams:u,pkceCodeVerifier:s.pkceCodeVerifier}})},Jr.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"THIRD_PARTY_SIGN_IN_UP",options:n.options,userContext:n.userContext}),Jr.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"THIRD_PARTY_SIGN_IN_UP",userContext:n.userContext}))];case 2:if(c=f.sent(),l=c.jsonBody,d=c.fetchResponse,"FIELD_ERROR"===l.status)throw new Yr.default(l.error);return"OK"!==l.status?[2,Gr(Gr({},l),{fetchResponse:d})]:[2,Gr(Gr({status:"OK"},(0,Kr.normaliseUserResponse)("thirdparty",l)),{fetchResponse:d})]}}))}))},generateStateToSendToOAuthProvider:function(e){var t={state:"".concat(1e20).replace(/[018]/g,(function(e){return(parseInt(e)^crypto.getRandomValues(new Uint8Array(1))[0]&15>>parseInt(e)/4).toString(16)}))};return void 0!==e&&void 0!==e.frontendRedirectURI&&(t.frontendRedirectURI=e.frontendRedirectURI),btoa(JSON.stringify(t))},verifyAndGetStateOrThrowError:function(e){return zr(this,void 0,void 0,(function(){return Qr(this,(function(t){if(void 0===e.stateObjectFromStorage||void 0===e.stateObjectFromStorage.stateForAuthProvider)throw new Error("No valid auth state present in session storage");if(void 0===e.stateFromAuthProvider)throw new Error("No state recieved from auth provider");if(e.stateObjectFromStorage.expiresAt<Date.now())throw new Error("Auth state verification failed. The auth provider took too long to respond");if(e.stateFromAuthProvider!==e.stateObjectFromStorage.stateForAuthProvider)throw new Error("Auth state verification failed. The auth provider responded with an invalid state");return[2,e.stateObjectFromStorage]}))}))},getAuthErrorFromURL:function(){return(0,Kr.getQueryParams)("error")},getAuthStateFromURL:function(){var e=(0,Kr.getQueryParams)("state");return void 0===e?"":e}}}Xr.default=Zr,Xr.getRecipeImplementation=Zr;var eo=Y&&Y.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),to=Y&&Y.__assign||function(){return to=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},to.apply(this,arguments)};Object.defineProperty(qr,"__esModule",{value:!0}),qr.Recipe=void 0;var no=Vr,ro=Nt,oo=Xr,so=oe,io=function(e){function t(t){var n=e.call(this,(0,no.normaliseUserInput)(t))||this,r=new ro.default((0,oo.default)({recipeId:n.config.recipeId,appInfo:n.config.appInfo,clientType:n.config.clientType,preAPIHook:n.config.preAPIHook,postAPIHook:n.config.postAPIHook}));return n.recipeImplementation=r.override(n.config.override.functions).build(),n}return eo(t,e),t.init=function(e){return function(n,r){return t.instance=new t(to(to({},e),{recipeId:t.RECIPE_ID,appInfo:n,clientType:r})),t.instance}},t.getInstanceOrThrow=function(){if(void 0===t.instance){var e="No instance of ThirdParty found. Ensure that the 'ThirdParty.init' method is called within the 'SuperTokens.init' recipeList.";throw e=(0,so.checkForSSRErrorAndAppendIfNeeded)(e),Error(e)}return t.instance},t.reset=function(){(0,so.isTest)()&&(t.instance=void 0)},t.RECIPE_ID="thirdparty",t}(Qn.default);qr.Recipe=io,qr.default=io;var ao={},uo=Y&&Y.__assign||function(){return uo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},uo.apply(this,arguments)};Object.defineProperty(ao,"__esModule",{value:!0}),ao.normaliseUserInput=void 0;var co=Tn;ao.normaliseUserInput=function(e){var t=uo({functions:function(e){return e}},e.override);return uo(uo({},(0,co.normaliseAuthRecipe)(e)),{override:t})};var lo={},fo={};Object.defineProperty(fo,"__esModule",{value:!0}),fo.default=function(e){return{doesEmailExist:e.doesEmailExist.bind(e),sendPasswordResetEmail:e.sendPasswordResetEmail.bind(e),submitNewPassword:e.submitNewPassword.bind(e),getResetPasswordTokenFromURL:e.getResetPasswordTokenFromURL.bind(e),signIn:e.emailPasswordSignIn.bind(e),signUp:e.emailPasswordSignUp.bind(e),getTenantIdFromURL:e.getTenantIdFromURL.bind(e)}};var ho={};Object.defineProperty(ho,"__esModule",{value:!0}),ho.default=function(e){return{getAuthorisationURLFromBackend:e.getAuthorisationURLFromBackend.bind(e),getStateAndOtherInfoFromStorage:e.getStateAndOtherInfoFromStorage.bind(e),getAuthorisationURLWithQueryParamsAndSetState:e.getAuthorisationURLWithQueryParamsAndSetState.bind(e),setStateAndOtherInfoToStorage:e.setStateAndOtherInfoToStorage.bind(e),generateStateToSendToOAuthProvider:e.generateStateToSendToOAuthProvider.bind(e),getAuthErrorFromURL:e.getAuthErrorFromURL.bind(e),getAuthStateFromURL:e.getAuthStateFromURL.bind(e),verifyAndGetStateOrThrowError:e.verifyAndGetStateOrThrowError.bind(e),signInAndUp:e.thirdPartySignInAndUp.bind(e)}};var po=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},go=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(lo,"__esModule",{value:!0}),lo.getRecipeImplementation=void 0;var vo=_r,bo=Xr,mo=fo,yo=ho;function wo(e){var t=(0,vo.default)(e),n=(0,bo.default)(e);return{submitNewPassword:function(e){return po(this,void 0,void 0,(function(){return go(this,(function(n){return[2,t.submitNewPassword.bind((0,mo.default)(this))(e)]}))}))},sendPasswordResetEmail:function(e){return po(this,void 0,void 0,(function(){return go(this,(function(n){return[2,t.sendPasswordResetEmail.bind((0,mo.default)(this))(e)]}))}))},doesEmailExist:function(e){return po(this,void 0,void 0,(function(){return go(this,(function(n){return[2,t.doesEmailExist.bind((0,mo.default)(this))(e)]}))}))},emailPasswordSignUp:function(e){return po(this,void 0,void 0,(function(){return go(this,(function(n){return[2,t.signUp.bind((0,mo.default)(this))(e)]}))}))},emailPasswordSignIn:function(e){return po(this,void 0,void 0,(function(){return go(this,(function(n){return[2,t.signIn.bind((0,mo.default)(this))(e)]}))}))},getResetPasswordTokenFromURL:function(e){return t.getResetPasswordTokenFromURL.bind((0,mo.default)(this))(e)},getAuthorisationURLFromBackend:function(e){return po(this,void 0,void 0,(function(){return go(this,(function(t){return[2,n.getAuthorisationURLFromBackend.bind((0,yo.default)(this))(e)]}))}))},thirdPartySignInAndUp:function(e){return po(this,void 0,void 0,(function(){return go(this,(function(t){return[2,n.signInAndUp.bind((0,yo.default)(this))(e)]}))}))},getStateAndOtherInfoFromStorage:function(e){return n.getStateAndOtherInfoFromStorage.bind((0,yo.default)(this))(e)},setStateAndOtherInfoToStorage:function(e){return po(this,void 0,void 0,(function(){return go(this,(function(t){return[2,n.setStateAndOtherInfoToStorage.bind((0,yo.default)(this))(e)]}))}))},getAuthorisationURLWithQueryParamsAndSetState:function(e){return po(this,void 0,void 0,(function(){return go(this,(function(t){return[2,n.getAuthorisationURLWithQueryParamsAndSetState.bind((0,yo.default)(this))(e)]}))}))},generateStateToSendToOAuthProvider:function(e){return n.generateStateToSendToOAuthProvider.bind((0,yo.default)(this))(e)},verifyAndGetStateOrThrowError:function(e){return po(this,void 0,void 0,(function(){return go(this,(function(t){return[2,n.verifyAndGetStateOrThrowError.bind((0,yo.default)(this))(e)]}))}))},getAuthErrorFromURL:function(e){return n.getAuthErrorFromURL.bind((0,yo.default)(this))(e)},getAuthStateFromURL:function(e){return n.getAuthStateFromURL.bind((0,yo.default)(this))(e)},getTenantIdFromURL:function(e){return t.getTenantIdFromURL.bind((0,mo.default)(this))(e)}}}lo.default=wo,lo.getRecipeImplementation=wo;var Io=Y&&Y.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),So=Y&&Y.__assign||function(){return So=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},So.apply(this,arguments)};Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.Recipe=void 0;var ko=Sr,To=qr,Ro=ao,_o=Nt,Po=lo,Ao=fo,xo=ho,Oo=oe,Eo=function(e){function t(t,n){var r=e.call(this,(0,Ro.normaliseUserInput)(t))||this,o=new _o.default((0,Po.default)({recipeId:r.config.recipeId,appInfo:r.config.appInfo,clientType:r.config.clientType,preAPIHook:r.config.preAPIHook,postAPIHook:r.config.postAPIHook})).override(r.config.override.functions).build();return r.recipeImplementation=o,r.emailPasswordRecipe=void 0===n.emailPassword?new ko.default({recipeId:r.config.recipeId,appInfo:r.config.appInfo,clientType:r.config.clientType,preAPIHook:t.preAPIHook,postAPIHook:t.postAPIHook,override:{functions:function(){return(0,Ao.default)(o)}}}):n.emailPassword,r.thirdPartyRecipe=void 0===n.thirdParty?new To.default({recipeId:r.config.recipeId,appInfo:r.config.appInfo,clientType:r.config.clientType,preAPIHook:t.preAPIHook,postAPIHook:t.postAPIHook,override:{functions:function(){return(0,xo.default)(o)}}}):n.thirdParty,r}return Io(t,e),t.getInstanceOrThrow=function(){if(void 0===t.instance){var e="No instance of ThirdPartyEmailPassword found. Ensure that the 'ThirdPartyEmailPassword.init' method is called within the 'SuperTokens.init' recipeList.";throw e=(0,Oo.checkForSSRErrorAndAppendIfNeeded)(e),Error(e)}return t.instance},t.init=function(e){return function(n,r){return t.instance=new t(So(So({},e),{recipeId:t.RECIPE_ID,appInfo:n,clientType:r}),{emailPassword:void 0,thirdParty:void 0}),t.instance}},t.reset=function(){(0,Oo.isTest)()&&(t.instance=void 0)},t.RECIPE_ID="thirdpartyemailpassword",t}(Qn.default);Ir.Recipe=Eo,Ir.default=Eo;var Co=Y&&Y.__assign||function(){return Co=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Co.apply(this,arguments)},Do=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))},Mo=Y&&Y.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(wr,"__esModule",{value:!0}),wr.getTenantIdFromURL=wr.getResetPasswordTokenFromURL=wr.signOut=wr.getAuthorisationURLWithQueryParamsAndSetState=wr.thirdPartySignInAndUp=wr.emailPasswordSignIn=wr.emailPasswordSignUp=wr.doesEmailExist=wr.getStateAndOtherInfoFromStorage=wr.sendPasswordResetEmail=wr.submitNewPassword=wr.init=void 0;var Uo=oe,Ho=Sn,Fo=Ir,No=function(){function e(){}return e.init=function(e){return Fo.default.init(e)},e.signOut=function(e){return Fo.default.getInstanceOrThrow().signOut({userContext:(0,Uo.getNormalisedUserContext)(null==e?void 0:e.userContext)})},e.submitNewPassword=function(e){return Fo.default.getInstanceOrThrow().recipeImplementation.submitNewPassword(Co(Co({},e),{userContext:(0,Uo.getNormalisedUserContext)(e.userContext)}))},e.sendPasswordResetEmail=function(e){return Fo.default.getInstanceOrThrow().recipeImplementation.sendPasswordResetEmail(Co(Co({},e),{userContext:(0,Uo.getNormalisedUserContext)(e.userContext)}))},e.getStateAndOtherInfoFromStorage=function(e){return Fo.default.getInstanceOrThrow().recipeImplementation.getStateAndOtherInfoFromStorage(Co(Co({},e),{userContext:(0,Uo.getNormalisedUserContext)(null==e?void 0:e.userContext)}))},e.doesEmailExist=function(e){return Fo.default.getInstanceOrThrow().recipeImplementation.doesEmailExist(Co(Co({},e),{userContext:(0,Uo.getNormalisedUserContext)(e.userContext)}))},e.emailPasswordSignUp=function(e){return Fo.default.getInstanceOrThrow().recipeImplementation.emailPasswordSignUp(Co(Co({},e),{userContext:(0,Uo.getNormalisedUserContext)(e.userContext)}))},e.emailPasswordSignIn=function(e){return Fo.default.getInstanceOrThrow().recipeImplementation.emailPasswordSignIn(Co(Co({},e),{userContext:(0,Uo.getNormalisedUserContext)(e.userContext)}))},e.getResetPasswordTokenFromURL=function(e){return Fo.default.getInstanceOrThrow().recipeImplementation.getResetPasswordTokenFromURL(Co(Co({},e),{userContext:(0,Uo.getNormalisedUserContext)(null==e?void 0:e.userContext)}))},e.getTenantIdFromURL=function(e){return Fo.default.getInstanceOrThrow().recipeImplementation.getTenantIdFromURL(Co(Co({},e),{userContext:(0,Uo.getNormalisedUserContext)(null==e?void 0:e.userContext)}))},e.thirdPartySignInAndUp=function(e){return Fo.default.getInstanceOrThrow().recipeImplementation.thirdPartySignInAndUp(Co(Co({},e),{userContext:(0,Uo.getNormalisedUserContext)(null==e?void 0:e.userContext)}))},e.getAuthorisationURLWithQueryParamsAndSetState=function(e){return Do(this,void 0,void 0,(function(){var t,n,r;return Mo(this,(function(o){switch(o.label){case 0:return t=(0,Uo.getNormalisedUserContext)(e.userContext),n=Fo.default.getInstanceOrThrow(),[4,Ho.default.getInstanceOrThrow().recipeImplementation.getTenantId({userContext:t})];case 1:return r=o.sent(),[2,n.recipeImplementation.getAuthorisationURLWithQueryParamsAndSetState(Co(Co({tenantId:r},e),{userContext:t}))]}}))}))},e}();wr.default=No;var Lo=No.init;wr.init=Lo;var jo=No.submitNewPassword;wr.submitNewPassword=jo;var qo=No.sendPasswordResetEmail;wr.sendPasswordResetEmail=qo;var Vo=No.getStateAndOtherInfoFromStorage;wr.getStateAndOtherInfoFromStorage=Vo;var Bo=No.doesEmailExist;wr.doesEmailExist=Bo;var Wo=No.emailPasswordSignUp;wr.emailPasswordSignUp=Wo;var Xo=No.emailPasswordSignIn;wr.emailPasswordSignIn=Xo;var Go=No.thirdPartySignInAndUp;wr.thirdPartySignInAndUp=Go;var zo=No.getAuthorisationURLWithQueryParamsAndSetState;wr.getAuthorisationURLWithQueryParamsAndSetState=zo;var Qo=No.getResetPasswordTokenFromURL;wr.getResetPasswordTokenFromURL=Qo;var Jo=No.getTenantIdFromURL;wr.getTenantIdFromURL=Jo;var Ko=No.signOut;wr.signOut=Ko,function(e){e.__esModule=!0,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(wr)}(yr);var Yo=$(yr);const $o=()=>{mr.init({appInfo:{apiDomain:"http://localhost:3001",apiBasePath:"",appName:"WC Test"},recipeList:[pn.init(),Yo.init()]})};var Zo=C("<div class=wrapper><header></header><main></main><footer>Built by SuperTokens"),es=C("<slot name=header>"),ts=C("<slot>"),ns=C("<slot name=footer>");function rs(e){const t=e.useSlots;return n=Zo(),r=n.firstChild,o=r.nextSibling,(s=o.nextSibling).firstChild,M(r,(()=>{return t?((n=es())._$owner=v(),n):e.header;var n})),M(o,(()=>{return t?((n=ts())._$owner=v(),n):e.children;var n})),M(s,(()=>{return t?((n=ns())._$owner=v(),n):e.footer;var n}),null),n;var n,r,o,s}export{O as S,h as a,x as b,d as c,D as d,pn as e,J as f,K as g,rs as h,M as i,v as j,yr as k,X as n,$o as s,C as t};
